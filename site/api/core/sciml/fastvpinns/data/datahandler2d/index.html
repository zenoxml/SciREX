
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../datahandler/">
      
      
        <link rel="next" href="../../model/model_hard/">
      
      
      <link rel="icon" href="../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>datahandler2 - SciREX Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../../../assets/custom.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="SciREX Documentation" class="md-header__button md-logo" aria-label="SciREX Documentation" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SciREX Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              datahandler2
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../ml/unsupervised/clustering/base/" class="md-tabs__link">
          
  
  Core

        </a>
      </li>
    
  

    
  

    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../tutorial/classification_tutorial/" class="md-tabs__link">
          
  
  Tutorial

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="SciREX Documentation" class="md-nav__button md-logo" aria-label="SciREX Documentation" data-md-component="logo">
      
  <img src="../../../../../../assets/logo.png" alt="logo">

    </a>
    SciREX Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Machine Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Machine Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Unsupervised
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            Unsupervised
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1_1_1" id="__nav_2_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Clustering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Clustering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/kmeans/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kmeans
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/agglomerative/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agglomerative
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/gmm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GMM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/hdbscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hdbscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/dbscan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dbscan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ml/unsupervised/clustering/optics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Postprocessing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Postprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../postprocessing/postprocessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postprocessing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Deep Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Deep Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dl/tensorflow_wrapper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tensorflow_wrapper
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    SciML
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            SciML
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_1" >
        
          
          <label class="md-nav__link" for="__nav_2_4_1" id="__nav_2_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_1">
            <span class="md-nav__icon md-icon"></span>
            Geometry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../geometry/geometry_2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geometry_2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../geometry/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geometry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_2" id="__nav_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    fe
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            fe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/basis_2d_QN_Chebyshev_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chebyshev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/basis_2d_QN_Jacobi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jacobi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/basis_2d_QN_Legendre_Special/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legendre_Special
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/basis_2d_QN_Legendre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Legendre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/basis_function_2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Function 2D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/basis_function_3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Function 3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/fe_transformation_2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FE_transformation_2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/fe_transformation_3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FE_transformation_3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/FE2D_Cell.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FE2D_Cell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/fe2d_setup_main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fe2d_setup_main
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/fespace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fespace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/fespace2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fespace2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/quad_affine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quad_affine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/quad_bilinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quad_bilinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/quadratureformulas_quad2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadratureformulas_quad2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fe/quadratureformulas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadratureformulas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4_3" id="__nav_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    fastvpinns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            fastvpinns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4_3_1" id="__nav_2_4_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    data
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4_3_1">
            <span class="md-nav__icon md-icon"></span>
            data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datahandler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datahandler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    datahandler2
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    datahandler2
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d" class="md-nav__link">
    <span class="md-ellipsis">
      datahandler2d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D" class="md-nav__link">
    <span class="md-ellipsis">
      DataHandler2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DataHandler2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_bilinear_params_dict_as_tensors" class="md-nav__link">
    <span class="md-ellipsis">
      get_bilinear_params_dict_as_tensors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_dirichlet_input" class="md-nav__link">
    <span class="md-ellipsis">
      get_dirichlet_input
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_inverse_params" class="md-nav__link">
    <span class="md-ellipsis">
      get_inverse_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_sensor_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensor_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_test_points" class="md-nav__link">
    <span class="md-ellipsis">
      get_test_points
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell" class="md-nav__link">
    <span class="md-ellipsis">
      FE2D_Cell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FE2D_Cell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_basis_function" class="md-nav__link">
    <span class="md-ellipsis">
      assign_basis_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_basis_values_at_quadrature_points" class="md-nav__link">
    <span class="md-ellipsis">
      assign_basis_values_at_quadrature_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_fe_transformation" class="md-nav__link">
    <span class="md-ellipsis">
      assign_fe_transformation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_forcing_term" class="md-nav__link">
    <span class="md-ellipsis">
      assign_forcing_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_quad_weights_and_jacobian" class="md-nav__link">
    <span class="md-ellipsis">
      assign_quad_weights_and_jacobian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_quadrature" class="md-nav__link">
    <span class="md-ellipsis">
      assign_quadrature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_quadrature_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      assign_quadrature_coordinates
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace" class="md-nav__link">
    <span class="md-ellipsis">
      Fespace
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fespace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.generate_dirichlet_boundary_data" class="md-nav__link">
    <span class="md-ellipsis">
      generate_dirichlet_boundary_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_forcing_function_values" class="md-nav__link">
    <span class="md-ellipsis">
      get_forcing_function_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_quadrature_actual_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      get_quadrature_actual_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_sensor_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensor_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_sensor_data_external" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensor_data_external
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_x" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_x_ref" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_x_ref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_y" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_y
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_y_ref" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_y_ref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_val" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_val
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.set_finite_elements" class="md-nav__link">
    <span class="md-ellipsis">
      set_finite_elements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D" class="md-nav__link">
    <span class="md-ellipsis">
      Fespace2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fespace2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.generate_dirichlet_boundary_data" class="md-nav__link">
    <span class="md-ellipsis">
      generate_dirichlet_boundary_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.generate_dirichlet_boundary_data_vector" class="md-nav__link">
    <span class="md-ellipsis">
      generate_dirichlet_boundary_data_vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.generate_plot" class="md-nav__link">
    <span class="md-ellipsis">
      generate_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_forcing_function_values" class="md-nav__link">
    <span class="md-ellipsis">
      get_forcing_function_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_forcing_function_values_vector" class="md-nav__link">
    <span class="md-ellipsis">
      get_forcing_function_values_vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_quadrature_actual_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      get_quadrature_actual_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_quadrature_weights" class="md-nav__link">
    <span class="md-ellipsis">
      get_quadrature_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_sensor_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensor_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_sensor_data_external" class="md-nav__link">
    <span class="md-ellipsis">
      get_sensor_data_external
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_x" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_x_ref" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_x_ref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_y" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_y
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_y_ref" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_grad_y_ref
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_val" class="md-nav__link">
    <span class="md-ellipsis">
      get_shape_function_val
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.set_finite_elements" class="md-nav__link">
    <span class="md-ellipsis">
      set_finite_elements
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geometry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.generate_vtk_for_test" class="md-nav__link">
    <span class="md-ellipsis">
      generate_vtk_for_test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.get_test_points" class="md-nav__link">
    <span class="md-ellipsis">
      get_test_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.read_mesh" class="md-nav__link">
    <span class="md-ellipsis">
      read_mesh
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D" class="md-nav__link">
    <span class="md-ellipsis">
      Geometry_2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Geometry_2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.generate_quad_mesh_internal" class="md-nav__link">
    <span class="md-ellipsis">
      generate_quad_mesh_internal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.generate_vtk_for_test" class="md-nav__link">
    <span class="md-ellipsis">
      generate_vtk_for_test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.get_test_points" class="md-nav__link">
    <span class="md-ellipsis">
      get_test_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.plot_adaptive_mesh" class="md-nav__link">
    <span class="md-ellipsis">
      plot_adaptive_mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.read_mesh" class="md-nav__link">
    <span class="md-ellipsis">
      read_mesh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.write_vtk" class="md-nav__link">
    <span class="md-ellipsis">
      write_vtk
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scirex.core.sciml.fastvpinns.data.datahandler2d.print_table" class="md-nav__link">
    <span class="md-ellipsis">
      print_table
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3_2" id="__nav_2_4_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/model_hard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model hard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/model_inverse_domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model inverse domain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/model_inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model inverse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model/model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_3_3" >
        
          
          <label class="md-nav__link" for="__nav_2_4_3_3" id="__nav_2_4_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Physics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            Physics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/cd2d_inverse_domain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cd2d_inverse_domain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/cd2d_inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cd2d_inverse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/cd2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cd2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/helmholtz2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    helmholtz2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/poisson2d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    poisson2d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/poisson_2d_inverse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    poissson2d Inverse
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4_4" id="__nav_2_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Super Resolution
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            Super Resolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../superresolution.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Super Resolution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial/classification_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification Tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>datahandler2</h1>

<div class="doc doc-object doc-module">



<a id="scirex.core.sciml.fastvpinns.data.datahandler2d"></a>
    <div class="doc doc-contents first">

        <p>Two-Dimensional Data Handler Implementation for PDE Solvers.</p>
<p>This module implements data handling functionality for 2D PDE problems,
focusing on efficient tensor conversions and management of finite element
data structures. It provides methods for converting numpy arrays to
tensorflow tensors and handling various aspects of the PDE solution process.</p>


<details class="the-implementation-supports" open>
  <summary>The implementation supports</summary>
  <ul>
<li>Shape function and gradient tensor management</li>
<li>Dirichlet boundary data processing</li>
<li>Test point generation and handling</li>
<li>Sensor data management for inverse problems</li>
<li>Bilinear parameter tensor conversion</li>
<li>Forcing function data handling</li>
</ul>
</details>

<details class="key-classes" open>
  <summary>Key classes</summary>
  <ul>
<li>DataHandler2D: Implementation for 2D PDE data handling</li>
</ul>
</details>

<details class="dependencies" open>
  <summary>Dependencies</summary>
  <ul>
<li>tensorflow: For tensor operations</li>
<li>numpy: For numerical arrays</li>
<li>FESpace2D: For finite element space handling</li>
<li>Domain2D: For domain management</li>
</ul>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>The implementation follows FastVPINNs methodology [1] for efficient
handling of finite element data structures.</p>
</details>

<details class="references" open>
  <summary>References</summary>
  <p>[1] FastVPINNs: Tensor-Driven Acceleration of VPINNs for Complex Geometries
    DOI: https://arxiv.org/abs/2404.12063</p>
</details>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D" class="doc doc-heading">
            <code>DataHandler2D</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="scirex.core.sciml.fastvpinns.data.datahandler.DataHandler" href="../datahandler/#scirex.core.sciml.fastvpinns.data.datahandler.DataHandler">DataHandler</a></code></p>


        <p>Handles data conversion and management for 2D PDE problems.</p>
<p>This class implements the DataHandler interface for 2D problems,
providing methods for converting finite element data to tensorflow
tensors and managing various aspects of the PDE solution process.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.fespace">fespace</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Finite element space object for mesh and element info</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.domain">domain</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain object for geometric information</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.dtype">dtype</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TensorFlow data type for tensor conversion</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.shape_val_mat_list">shape_val_mat_list</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor of shape function values
Shape: List of matrices of shape (n_test_functions, n_quad_points) with length n_elements</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.grad_x_mat_list">grad_x_mat_list</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor of x-derivatives
Shape: List of matrices of shape (n_test_functions, n_quad_points) with length n_elements</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.grad_y_mat_list">grad_y_mat_list</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor of y-derivatives
Shape: List of matrices of shape (n_test_functions, n_quad_points) with length n_elements</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.x_pde_list">x_pde_list</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor of quadrature point coordinates</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.forcing_function_list">forcing_function_list</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor of forcing function values</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.test_points">test_points</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor of test point coordinates</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>fespace = FESpace2D(mesh, elements)
domain = Domain2D(bounds)
handler = DataHandler2D(fespace, domain, tf.float32)
dirichlet_input, dirichlet_vals = handler.get_dirichlet_input()
test_points = handler.get_test_points()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>All input numpy arrays are assumed to be float64. The class handles
conversion to the specified tensorflow dtype (typically float32)
for computational efficiency.</p>
</details>





              <details class="quote">
                <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="k">class</span> <span class="nc">DataHandler2D</span><span class="p">(</span><span class="n">DataHandler</span><span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles data conversion and management for 2D PDE problems.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    This class implements the DataHandler interface for 2D problems,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    providing methods for converting finite element data to tensorflow</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    tensors and managing various aspects of the PDE solution process.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        fespace: Finite element space object for mesh and element info</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        domain: Domain object for geometric information</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        dtype: TensorFlow data type for tensor conversion</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        shape_val_mat_list: Tensor of shape function values</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            Shape: List of matrices of shape (n_test_functions, n_quad_points) with length n_elements</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        grad_x_mat_list: Tensor of x-derivatives</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            Shape: List of matrices of shape (n_test_functions, n_quad_points) with length n_elements</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        grad_y_mat_list: Tensor of y-derivatives</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            Shape: List of matrices of shape (n_test_functions, n_quad_points) with length n_elements</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        x_pde_list: Tensor of quadrature point coordinates</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        forcing_function_list: Tensor of forcing function values</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        test_points: Tensor of test point coordinates</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        &gt;&gt;&gt; fespace = FESpace2D(mesh, elements)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        &gt;&gt;&gt; domain = Domain2D(bounds)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        &gt;&gt;&gt; handler = DataHandler2D(fespace, domain, tf.float32)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        &gt;&gt;&gt; dirichlet_input, dirichlet_vals = handler.get_dirichlet_input()</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        &gt;&gt;&gt; test_points = handler.get_test_points()</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        All input numpy arrays are assumed to be float64. The class handles</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        conversion to the specified tensorflow dtype (typically float32)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        for computational efficiency.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fespace</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Constructor for the DataHandler2D class</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">            fespace (FESpace2D): The FESpace2D object.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            domain (Domain2D): The Domain2D object.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            dtype (tf.DType): The tensorflow dtype to be used for all the tensors.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            None</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="c1"># call the parent class constructor</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fespace</span><span class="o">=</span><span class="n">fespace</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="c1"># check if the given dtype is a valid tensorflow dtype</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">):</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The given dtype is not a valid tensorflow dtype&quot;</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">for</span> <span class="n">cell_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">n_cells</span><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">shape_val_mat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_shape_function_val</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">grad_x_mat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_shape_function_grad_x</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="n">grad_y_mat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_shape_function_grad_y</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">x_pde</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">forcing_function</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_forcing_function_values</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_val_mat</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grad_x_mat</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grad_y_mat</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_pde</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forcing_function</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="c1"># now convert all the shapes into 3D tensors for easy multiplication</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="c1"># input tensor - x_pde_list</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="c1"># test points</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">def</span> <span class="nf">get_dirichlet_input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        This function will return the input for the Dirichlet boundary data</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            None</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            The Dirichlet boundary data as a tuple of tensors</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">input_dirichlet</span><span class="p">,</span> <span class="n">actual_dirichlet</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">generate_dirichlet_boundary_data</span><span class="p">()</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="c1"># convert to tensors</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">input_dirichlet</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">input_dirichlet</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">actual_dirichlet</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">actual_dirichlet</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">actual_dirichlet</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">actual_dirichlet</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="k">return</span> <span class="n">input_dirichlet</span><span class="p">,</span> <span class="n">actual_dirichlet</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">def</span> <span class="nf">get_test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        Get the test points for the given domain.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            None</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            The test points as a tensor</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">get_test_points</span><span class="p">()</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">def</span> <span class="nf">get_bilinear_params_dict_as_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        Accepts a function from example file and converts all the values into tensors of the given dtype</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            function (function): The function from the example file which returns the bilinear parameters dictionary</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            The bilinear parameters dictionary with all the values converted to tensors</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="c1"># get the dictionary of bilinear parameters</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">bilinear_params_dict</span> <span class="o">=</span> <span class="n">function</span><span class="p">()</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="c1"># loop over all keys and convert the values to tensors</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bilinear_params_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">bilinear_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">bilinear_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">return</span> <span class="n">bilinear_params_dict</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="c1"># to be used only in inverse problems</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">def</span> <span class="nf">get_sensor_data</span><span class="p">(</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span><span class="p">,</span> <span class="n">mesh_type</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Accepts a function from example file and converts all the values into tensors of the given dtype</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            exact_sol (function): The exact solution function</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            num_sensor_points (int): The number of sensor points</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            mesh_type (str): The type of mesh</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            file_name (str): The file name to save the sensor data</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            The sensor data as a tensor</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            ValueError: If the mesh type is not internal or external</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mesh_type = </span><span class="si">{</span><span class="n">mesh_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">if</span> <span class="n">mesh_type</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="c1"># Call the method to get the sensor data</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">points</span><span class="p">,</span> <span class="n">sensor_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_sensor_data</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">elif</span> <span class="n">mesh_type</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="c1"># Call the method to get the sensor data</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="n">points</span><span class="p">,</span> <span class="n">sensor_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_sensor_data_external</span><span class="p">(</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>                <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span><span class="p">,</span> <span class="n">file_name</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="c1"># convert the points and sensor values into tensors</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">sensor_values</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">sensor_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">sensor_values</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sensor_values</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">sensor_values</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="c1"># get inverse param dict as tensors</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">def</span> <span class="nf">get_inverse_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inverse_params_dict_function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        Accepts a function from example file and converts all the values into tensors of the given dtype</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            inverse_params_dict_function (function): The function from the example file which returns the inverse parameters dictionary</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            The inverse parameters dictionary with all the values converted to tensors</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="c1"># loop over all keys and convert the values to tensors</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">inverse_params_dict</span> <span class="o">=</span> <span class="n">inverse_params_dict_function</span><span class="p">()</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inverse_params_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">inverse_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                <span class="n">inverse_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">return</span> <span class="n">inverse_params_dict</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">fespace</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for the DataHandler2D class</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fespace</code>
            </td>
            <td>
                  <code>FESpace2D</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The FESpace2D object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain</code>
            </td>
            <td>
                  <code>Domain2D</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Domain2D object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="tensorflow.DType">DType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The tensorflow dtype to be used for all the tensors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fespace</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    Constructor for the DataHandler2D class</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        fespace (FESpace2D): The FESpace2D object.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        domain (Domain2D): The Domain2D object.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        dtype (tf.DType): The tensorflow dtype to be used for all the tensors.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        None</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="c1"># call the parent class constructor</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fespace</span><span class="o">=</span><span class="n">fespace</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="c1"># check if the given dtype is a valid tensorflow dtype</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">):</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The given dtype is not a valid tensorflow dtype&quot;</span><span class="p">)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">for</span> <span class="n">cell_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">n_cells</span><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">shape_val_mat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_shape_function_val</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">grad_x_mat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_shape_function_grad_x</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">grad_y_mat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_shape_function_grad_y</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">x_pde</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">forcing_function</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_forcing_function_values</span><span class="p">(</span><span class="n">cell_index</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shape_val_mat</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grad_x_mat</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grad_y_mat</span><span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_pde</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">forcing_function</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1"># now convert all the shapes into 3D tensors for easy multiplication</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="c1"># input tensor - x_pde_list</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_pde_list</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forcing_function_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape_val_mat_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_x_mat_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_y_mat_list</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="c1"># test points</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_bilinear_params_dict_as_tensors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bilinear_params_dict_as_tensors</span><span class="p">(</span><span class="n">function</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Accepts a function from example file and converts all the values into tensors of the given dtype</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>function</code>
            </td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function from the example file which returns the bilinear parameters dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The bilinear parameters dictionary with all the values converted to tensors</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="k">def</span> <span class="nf">get_bilinear_params_dict_as_tensors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Accepts a function from example file and converts all the values into tensors of the given dtype</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        function (function): The function from the example file which returns the bilinear parameters dictionary</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        The bilinear parameters dictionary with all the values converted to tensors</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="c1"># get the dictionary of bilinear parameters</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">bilinear_params_dict</span> <span class="o">=</span> <span class="n">function</span><span class="p">()</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># loop over all keys and convert the values to tensors</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">bilinear_params_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">bilinear_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">bilinear_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">return</span> <span class="n">bilinear_params_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_dirichlet_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_dirichlet_input</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function will return the input for the Dirichlet boundary data</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Dirichlet boundary data as a tuple of tensors</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="k">def</span> <span class="nf">get_dirichlet_input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    This function will return the input for the Dirichlet boundary data</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        None</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        The Dirichlet boundary data as a tuple of tensors</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">input_dirichlet</span><span class="p">,</span> <span class="n">actual_dirichlet</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">generate_dirichlet_boundary_data</span><span class="p">()</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="c1"># convert to tensors</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">input_dirichlet</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">input_dirichlet</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">actual_dirichlet</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">actual_dirichlet</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">actual_dirichlet</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">actual_dirichlet</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">return</span> <span class="n">input_dirichlet</span><span class="p">,</span> <span class="n">actual_dirichlet</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_inverse_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_inverse_params</span><span class="p">(</span><span class="n">inverse_params_dict_function</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Accepts a function from example file and converts all the values into tensors of the given dtype</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inverse_params_dict_function</code>
            </td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function from the example file which returns the inverse parameters dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inverse parameters dictionary with all the values converted to tensors</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="k">def</span> <span class="nf">get_inverse_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inverse_params_dict_function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    Accepts a function from example file and converts all the values into tensors of the given dtype</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        inverse_params_dict_function (function): The function from the example file which returns the inverse parameters dictionary</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        The inverse parameters dictionary with all the values converted to tensors</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="c1"># loop over all keys and convert the values to tensors</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">inverse_params_dict</span> <span class="o">=</span> <span class="n">inverse_params_dict_function</span><span class="p">()</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inverse_params_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">inverse_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">inverse_params_dict</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">return</span> <span class="n">inverse_params_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_sensor_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sensor_data</span><span class="p">(</span><span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span><span class="p">,</span> <span class="n">mesh_type</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Accepts a function from example file and converts all the values into tensors of the given dtype</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exact_sol</code>
            </td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact solution function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_sensor_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of sensor points</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mesh_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of mesh</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file name to save the sensor data</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sensor data as a tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the mesh type is not internal or external</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="k">def</span> <span class="nf">get_sensor_data</span><span class="p">(</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span><span class="p">,</span> <span class="n">mesh_type</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="kc">None</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    Accepts a function from example file and converts all the values into tensors of the given dtype</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        exact_sol (function): The exact solution function</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        num_sensor_points (int): The number of sensor points</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        mesh_type (str): The type of mesh</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        file_name (str): The file name to save the sensor data</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        The sensor data as a tensor</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        ValueError: If the mesh type is not internal or external</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mesh_type = </span><span class="si">{</span><span class="n">mesh_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">if</span> <span class="n">mesh_type</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="c1"># Call the method to get the sensor data</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">points</span><span class="p">,</span> <span class="n">sensor_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_sensor_data</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">elif</span> <span class="n">mesh_type</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="c1"># Call the method to get the sensor data</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">points</span><span class="p">,</span> <span class="n">sensor_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fespace</span><span class="o">.</span><span class="n">get_sensor_data_external</span><span class="p">(</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_sensor_points</span><span class="p">,</span> <span class="n">file_name</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="c1"># convert the points and sensor values into tensors</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">sensor_values</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">sensor_values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">sensor_values</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">sensor_values</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">sensor_values</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.DataHandler2D.get_test_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_test_points</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the test points for the given domain.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tensorflow.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The test points as a tensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fastvpinns\data\datahandler2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="k">def</span> <span class="nf">get_test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    Get the test points for the given domain.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        None</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        The test points as a tensor</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">get_test_points</span><span class="p">()</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">test_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell" class="doc doc-heading">
            <code>FE2D_Cell</code>


</h2>


    <div class="doc doc-contents ">


        <p>A class for managing finite element computations at the cell level.</p>
<p>This class handles the storage and computation of finite element values,
including basis functions, quadrature rules, and transformations for a
single cell in a 2D mesh.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.cell_coordinates">cell_coordinates</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Physical coordinates of the cell vertices</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.cell_type">cell_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of the cell (e.g., 'quad', 'triangle')</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.fe_order">fe_order</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of the finite element approximation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.fe_type">fe_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of finite element basis</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.quad_order">quad_order</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of quadrature rule</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.quad_type">quad_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of quadrature formula</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.fe_transformation">fe_transformation</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of geometric transformation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.forcing_function">forcing_function</span></code></td>
            <td>
                  <code>callable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source term function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.basis_function">basis_function</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="scirex.core.sciml.fe.fe2d_setup_main.BasisFunction2D" href="../../../fe/fe2d_setup_main/#scirex.core.sciml.fe.fe2d_setup_main.BasisFunction2D">BasisFunction2D</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Basis function implementation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.quad_xi">quad_xi</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Xi coordinates of quadrature points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.quad_eta">quad_eta</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Eta coordinates of quadrature points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.quad_weight">quad_weight</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Quadrature weights</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.jacobian">jacobian</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformation Jacobian</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.basis_at_quad">basis_at_quad</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Basis values at quadrature points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.basis_gradx_at_quad">basis_gradx_at_quad</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-derivatives at quadrature points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.basis_grady_at_quad">basis_grady_at_quad</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Y-derivatives at quadrature points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.quad_actual_coordinates">quad_actual_coordinates</span></code></td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Physical quadrature point coordinates</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>coords = np.array([[0,0], [1,0], [1,1], [0,1]])
cell = FE2D_Cell(
...     cell_coordinates=coords,
...     cell_type='quad',
...     fe_order=2,
...     fe_type='lagrange',
...     quad_order=3,
...     quad_type='gauss',
...     fe_transformation_type='bilinear',
...     forcing_function=lambda x, y: x*y
... )
cell.basis_at_quad  # Get basis values at quadrature points</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>All gradient and derivative values are stored in the reference domain</li>
<li>Jacobian and quadrature weights are combined for efficiency</li>
<li>Forcing function values are typically computed in the fespace class</li>
<li>Supports multiple types of transformations and element types</li>
</ul>
</details>





              <details class="quote">
                <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">class</span> <span class="nc">FE2D_Cell</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    A class for managing finite element computations at the cell level.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    This class handles the storage and computation of finite element values,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    including basis functions, quadrature rules, and transformations for a</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    single cell in a 2D mesh.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        cell_coordinates (np.ndarray): Physical coordinates of the cell vertices</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        cell_type (str): Type of the cell (e.g., &#39;quad&#39;, &#39;triangle&#39;)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        fe_order (int): Order of the finite element approximation</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        fe_type (str): Type of finite element basis</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        quad_order (int): Order of quadrature rule</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        quad_type (str): Type of quadrature formula</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        fe_transformation (str): Type of geometric transformation</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        forcing_function (callable): Source term function</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        basis_function (BasisFunction2D): Basis function implementation</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        quad_xi (np.ndarray): Xi coordinates of quadrature points</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        quad_eta (np.ndarray): Eta coordinates of quadrature points</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        quad_weight (np.ndarray): Quadrature weights</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        jacobian (np.ndarray): Transformation Jacobian</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        basis_at_quad (np.ndarray): Basis values at quadrature points</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        basis_gradx_at_quad (np.ndarray): X-derivatives at quadrature points</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        basis_grady_at_quad (np.ndarray): Y-derivatives at quadrature points</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        quad_actual_coordinates (np.ndarray): Physical quadrature point coordinates</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        &gt;&gt;&gt; coords = np.array([[0,0], [1,0], [1,1], [0,1]])</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        &gt;&gt;&gt; cell = FE2D_Cell(</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        ...     cell_coordinates=coords,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        ...     cell_type=&#39;quad&#39;,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        ...     fe_order=2,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        ...     fe_type=&#39;lagrange&#39;,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        ...     quad_order=3,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        ...     quad_type=&#39;gauss&#39;,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        ...     fe_transformation_type=&#39;bilinear&#39;,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        ...     forcing_function=lambda x, y: x*y</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        &gt;&gt;&gt; cell.basis_at_quad  # Get basis values at quadrature points</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        - All gradient and derivative values are stored in the reference domain</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        - Jacobian and quadrature weights are combined for efficiency</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        - Forcing function values are typically computed in the fespace class</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        - Supports multiple types of transformations and element types</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">cell_coordinates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">cell_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">fe_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">fe_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">quad_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">quad_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">fe_transformation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="p">):</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        Constructor for the FE2D_Cell class.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            cell_coordinates (np.ndarray): Physical coordinates of the cell vertices</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            cell_type (str): Type of the cell (e.g., &#39;quad&#39;, &#39;triangle&#39;)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            fe_order (int): Order of the finite element approximation</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            fe_type (str): Type of finite element basis</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            quad_order (int): Order of quadrature rule</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            quad_type (str): Type of quadrature formula</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            fe_transformation_type (str): Type of geometric transformation</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            forcing_function (callable): Source term function</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            None</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cell_coordinates</span> <span class="o">=</span> <span class="n">cell_coordinates</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span> <span class="o">=</span> <span class="n">cell_type</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span> <span class="o">=</span> <span class="n">fe_order</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span> <span class="o">=</span> <span class="n">fe_type</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span> <span class="o">=</span> <span class="n">quad_order</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span> <span class="o">=</span> <span class="n">quad_type</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation</span> <span class="o">=</span> <span class="n">fe_transformation_type</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span> <span class="o">=</span> <span class="n">forcing_function</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="c1"># Basis function Class</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="c1"># Quadrature Values</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_weight</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jacobian</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mult</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="c1"># FE Values</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="c1"># Quadrature Coordinates</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_actual_coordinates</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="c1"># Forcing function values at the quadrature points</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="c1"># FE Transformation Class</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># get instance of the FE_setup class</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span> <span class="o">=</span> <span class="n">FE2DSetupMain</span><span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">cell_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="n">fe_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">fe_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">quad_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">quad_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="c1"># Call the function to assign the basis function</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_basis_function</span><span class="p">()</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="c1"># Assign the quadrature points and weights</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_quadrature</span><span class="p">()</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># Assign the FE Transformation</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_fe_transformation</span><span class="p">()</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="c1"># calculate mult -&gt; quadrature weights * Jacobian</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_quad_weights_and_jacobian</span><span class="p">()</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="c1"># Calculate the basis function values at the quadrature points</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_basis_values_at_quadrature_points</span><span class="p">()</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="c1"># calculate the actual coordinates of the quadrature points</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_quadrature_coordinates</span><span class="p">()</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="c1"># Calculate the forcing function values at the actual quadrature points</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="c1"># NOTE : The function is just for printing the shape of the force matrix, the</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="c1"># actual calculation is performed on the fespace class</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assign_forcing_term</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="c1"># # print the values</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="c1"># print(&quot;============================================================================&quot;)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="c1"># print(&quot;Cell Co-ord : &quot;, self.cell_coordinates)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="c1"># print(&quot;Basis function values at the quadrature points: \n&quot;, self.basis_at_quad / self.mult)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="c1"># print(&quot;Basis function gradx at the quadrature points: \n&quot;, self.basis_gradx_at_quad)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="c1"># print(&quot;Basis function grady at the quadrature points: \n&quot;, self.basis_grady_at_quad)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="c1"># print(&quot;Forcing function values at the quadrature points: \n&quot;, self.forcing_at_quad)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="c1"># grad_x = np.array([5,6,7,8])</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="c1"># grad_y = np.array([1,2,3,4])</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="c1"># pde = np.matmul(self.basis_gradx_at_quad, grad_x.reshape(-1,1)) + np.matmul(self.basis_grady_at_quad, grad_y.reshape(-1,1))</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="c1"># print(&quot;PDE values at the quadrature points: \n&quot;, pde)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">def</span> <span class="nf">assign_basis_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BasisFunction2D</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        Assigns the basis function class based on the cell type and the FE order.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            None</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            BasisFunction2D: The basis function class for the given cell type and FE order.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span><span class="o">.</span><span class="n">assign_basis_function</span><span class="p">()</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">def</span> <span class="nf">assign_quadrature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Assigns the quadrature points and weights based on the cell type and the quadrature order.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            None</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            None</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span><span class="o">.</span><span class="n">assign_quadrature_rules</span><span class="p">()</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">def</span> <span class="nf">assign_fe_transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        Assigns the FE Transformation class based on the cell type and the FE order.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        This method assigns the appropriate FE Transformation class based on the cell type and the FE order.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        It sets the cell coordinates for the FE Transformation and obtains the Jacobian of the transformation.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            None</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            None</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span><span class="o">.</span><span class="n">assign_fe_transformation</span><span class="p">(</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_coordinates</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="c1"># Sets cell co-ordinates for the FE Transformation</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">set_cell</span><span class="p">()</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="c1"># obtains the Jacobian of the transformation</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jacobian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_jacobian</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="k">def</span> <span class="nf">assign_basis_values_at_quadrature_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        Assigns the basis function values at the quadrature points.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        This method calculates the values of the basis functions and their gradients at the quadrature points.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        The basis function values are stored in `self.basis_at_quad`, while the gradients are stored in</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        `self.basis_gradx_at_quad`, `self.basis_grady_at_quad`, `self.basis_gradxy_at_quad`,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        `self.basis_gradxx_at_quad`, and `self.basis_gradyy_at_quad`.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            None</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            None</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="c1"># For Gradients we need to perform a transformation to the original cell</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">grad_x_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">grad_y_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">grady</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">grad_x_orig</span><span class="p">,</span> <span class="n">grad_y_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_orig_from_ref_derivative</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="n">grad_x_ref</span><span class="p">,</span> <span class="n">grad_y_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="n">grad_x_orig</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="n">grad_y_orig</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad_ref</span> <span class="o">=</span> <span class="n">grad_x_ref</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad_ref</span> <span class="o">=</span> <span class="n">grad_y_ref</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="c1"># get the double derivatives of the basis functions ( ref co-ordinates )</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="n">grad_xx_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradxx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="n">grad_xy_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradxy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="n">grad_yy_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradyy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="c1"># get the double derivatives of the basis functions ( orig co-ordinates )</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="n">grad_xx_orig</span><span class="p">,</span> <span class="n">grad_xy_orig</span><span class="p">,</span> <span class="n">grad_yy_orig</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_orig_from_ref_second_derivative</span><span class="p">(</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                <span class="n">grad_xx_ref</span><span class="p">,</span> <span class="n">grad_xy_ref</span><span class="p">,</span> <span class="n">grad_yy_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="c1"># = the value</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="n">grad_xy_orig</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="n">grad_xx_orig</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="n">grad_yy_orig</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="c1"># Multiply each row with the quadrature weights</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="c1"># Basis at Quad - n_test * N_quad</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="k">def</span> <span class="nf">assign_quad_weights_and_jacobian</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        Assigns the quadrature weights and the Jacobian of the transformation.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        This method calculates and assigns the quadrature weights and the Jacobian of the transformation</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        for the current cell. The quadrature weights are multiplied by the flattened Jacobian array</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        and stored in the `mult` attribute of the class.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            None</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            None</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jacobian</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="k">def</span> <span class="nf">assign_quadrature_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        Assigns the actual coordinates of the quadrature points.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        This method calculates the actual coordinates of the quadrature points based on the given Xi and Eta values.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        The Xi and Eta values are obtained from the `quad_xi` and `quad_eta` attributes of the class.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        The calculated coordinates are stored in the `quad_actual_coordinates` attribute as a NumPy array.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            None</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            None</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">actual_co_ord</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">):</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="n">actual_co_ord</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_original_from_ref</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">))</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_actual_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">actual_co_ord</span><span class="p">)</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="k">def</span> <span class="nf">assign_forcing_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forcing_function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Assigns the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        This function computes the values of the forcing function at the quadrature points</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        and assigns them to the `forcing_at_quad` attribute of the FE2D_Cell object.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            forcing_function (callable): The forcing function to be integrated</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">            None</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            - The final shape of `forcing_at_quad` will be N_shape_functions x 1.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">            - This function is for backward compatibility with old code and currently assigns</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">              the values as zeros. The actual calculation is performed in the fespace class.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="c1"># get number of shape functions</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="n">n_shape_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">num_shape_functions</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="c1"># Loop over all the basis functions and compute the integral</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="n">f_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_shape_functions</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="c1"># The above code is for backward compatibility with old code. this function will just assign the values as zeros</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="c1"># the actual calculation is performed in the fespace class</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="c1"># for i in range(n_shape_functions):</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="c1">#     val = 0</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="c1">#     for q in range(self.basis_at_quad.shape[1]):</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="c1">#         x = self.quad_actual_coordinates[q, 0]</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="c1">#         y = self.quad_actual_coordinates[q, 1]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="c1">#         # print(&quot;f_values[q] = &quot;,f_values[q])</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="c1">#         # the JAcobian and the quadrature weights are pre multiplied to the basis functions</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="c1">#         val +=  ( self.basis_at_quad[i, q] ) * self.forcing_function(x, y)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="c1">#         # print(&quot;val = &quot;, val)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="c1">#     f_integral[i] = val</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="n">f_integral</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">cell_coordinates</span><span class="p">,</span> <span class="n">cell_type</span><span class="p">,</span> <span class="n">fe_order</span><span class="p">,</span> <span class="n">fe_type</span><span class="p">,</span> <span class="n">quad_order</span><span class="p">,</span> <span class="n">quad_type</span><span class="p">,</span> <span class="n">fe_transformation_type</span><span class="p">,</span> <span class="n">forcing_function</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for the FE2D_Cell class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_coordinates</code>
            </td>
            <td>
                  <code><span title="scirex.core.sciml.fe.fe2d_setup_main.np.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Physical coordinates of the cell vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cell_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of the cell (e.g., 'quad', 'triangle')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_order</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of the finite element approximation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of finite element basis</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quad_order</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of quadrature rule</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quad_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of quadrature formula</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_transformation_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of geometric transformation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>forcing_function</code>
            </td>
            <td>
                  <code>callable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source term function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">cell_coordinates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">cell_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">fe_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">fe_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">quad_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">quad_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">fe_transformation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="p">):</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Constructor for the FE2D_Cell class.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        cell_coordinates (np.ndarray): Physical coordinates of the cell vertices</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        cell_type (str): Type of the cell (e.g., &#39;quad&#39;, &#39;triangle&#39;)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        fe_order (int): Order of the finite element approximation</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        fe_type (str): Type of finite element basis</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        quad_order (int): Order of quadrature rule</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        quad_type (str): Type of quadrature formula</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        fe_transformation_type (str): Type of geometric transformation</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        forcing_function (callable): Source term function</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        None</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cell_coordinates</span> <span class="o">=</span> <span class="n">cell_coordinates</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span> <span class="o">=</span> <span class="n">cell_type</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span> <span class="o">=</span> <span class="n">fe_order</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span> <span class="o">=</span> <span class="n">fe_type</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span> <span class="o">=</span> <span class="n">quad_order</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span> <span class="o">=</span> <span class="n">quad_type</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation</span> <span class="o">=</span> <span class="n">fe_transformation_type</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span> <span class="o">=</span> <span class="n">forcing_function</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="c1"># Basis function Class</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="c1"># Quadrature Values</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_weight</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">jacobian</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mult</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># FE Values</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="c1"># Quadrature Coordinates</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_actual_coordinates</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="c1"># Forcing function values at the quadrature points</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="c1"># FE Transformation Class</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="c1"># get instance of the FE_setup class</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span> <span class="o">=</span> <span class="n">FE2DSetupMain</span><span class="p">(</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">cell_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">fe_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">fe_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">quad_order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">quad_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="c1"># Call the function to assign the basis function</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_basis_function</span><span class="p">()</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="c1"># Assign the quadrature points and weights</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_quadrature</span><span class="p">()</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Assign the FE Transformation</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_fe_transformation</span><span class="p">()</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1"># calculate mult -&gt; quadrature weights * Jacobian</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_quad_weights_and_jacobian</span><span class="p">()</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="c1"># Calculate the basis function values at the quadrature points</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_basis_values_at_quadrature_points</span><span class="p">()</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># calculate the actual coordinates of the quadrature points</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_quadrature_coordinates</span><span class="p">()</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="c1"># Calculate the forcing function values at the actual quadrature points</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="c1"># NOTE : The function is just for printing the shape of the force matrix, the</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="c1"># actual calculation is performed on the fespace class</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">assign_forcing_term</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_basis_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_basis_function</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the basis function class based on the cell type and the FE order.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>BasisFunction2D</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="scirex.core.sciml.fe.fe2d_setup_main.BasisFunction2D" href="../../../fe/fe2d_setup_main/#scirex.core.sciml.fe.fe2d_setup_main.BasisFunction2D">BasisFunction2D</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The basis function class for the given cell type and FE order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="k">def</span> <span class="nf">assign_basis_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BasisFunction2D</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Assigns the basis function class based on the cell type and the FE order.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        None</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        BasisFunction2D: The basis function class for the given cell type and FE order.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span><span class="o">.</span><span class="n">assign_basis_function</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_basis_values_at_quadrature_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_basis_values_at_quadrature_points</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the basis function values at the quadrature points.</p>
<p>This method calculates the values of the basis functions and their gradients at the quadrature points.
The basis function values are stored in <code>self.basis_at_quad</code>, while the gradients are stored in
<code>self.basis_gradx_at_quad</code>, <code>self.basis_grady_at_quad</code>, <code>self.basis_gradxy_at_quad</code>,
<code>self.basis_gradxx_at_quad</code>, and <code>self.basis_gradyy_at_quad</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="k">def</span> <span class="nf">assign_basis_values_at_quadrature_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    Assigns the basis function values at the quadrature points.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    This method calculates the values of the basis functions and their gradients at the quadrature points.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    The basis function values are stored in `self.basis_at_quad`, while the gradients are stored in</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    `self.basis_gradx_at_quad`, `self.basis_grady_at_quad`, `self.basis_gradxy_at_quad`,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    `self.basis_gradxx_at_quad`, and `self.basis_gradyy_at_quad`.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        None</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        None</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="c1"># For Gradients we need to perform a transformation to the original cell</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="n">grad_x_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="n">grad_y_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">grady</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">grad_x_orig</span><span class="p">,</span> <span class="n">grad_y_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_orig_from_ref_derivative</span><span class="p">(</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">grad_x_ref</span><span class="p">,</span> <span class="n">grad_y_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="n">grad_x_orig</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="n">grad_y_orig</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad_ref</span> <span class="o">=</span> <span class="n">grad_x_ref</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad_ref</span> <span class="o">=</span> <span class="n">grad_y_ref</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="c1"># get the double derivatives of the basis functions ( ref co-ordinates )</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">grad_xx_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradxx</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">grad_xy_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradxy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">grad_yy_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">gradyy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="c1"># get the double derivatives of the basis functions ( orig co-ordinates )</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">grad_xx_orig</span><span class="p">,</span> <span class="n">grad_xy_orig</span><span class="p">,</span> <span class="n">grad_yy_orig</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_orig_from_ref_second_derivative</span><span class="p">(</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="n">grad_xx_ref</span><span class="p">,</span> <span class="n">grad_xy_ref</span><span class="p">,</span> <span class="n">grad_yy_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="c1"># = the value</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="n">grad_xy_orig</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="n">grad_xx_orig</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="n">grad_yy_orig</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="c1"># Multiply each row with the quadrature weights</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="c1"># Basis at Quad - n_test * N_quad</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_grady_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxy_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradxx_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_gradyy_at_quad</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mult</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_fe_transformation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_fe_transformation</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the FE Transformation class based on the cell type and the FE order.</p>
<p>This method assigns the appropriate FE Transformation class based on the cell type and the FE order.
It sets the cell coordinates for the FE Transformation and obtains the Jacobian of the transformation.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="k">def</span> <span class="nf">assign_fe_transformation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    Assigns the FE Transformation class based on the cell type and the FE order.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    This method assigns the appropriate FE Transformation class based on the cell type and the FE order.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    It sets the cell coordinates for the FE Transformation and obtains the Jacobian of the transformation.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        None</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        None</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span><span class="o">.</span><span class="n">assign_fe_transformation</span><span class="p">(</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_coordinates</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="c1"># Sets cell co-ordinates for the FE Transformation</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">set_cell</span><span class="p">()</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="c1"># obtains the Jacobian of the transformation</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">jacobian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_jacobian</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_forcing_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_forcing_term</span><span class="p">(</span><span class="n">forcing_function</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the forcing function values at the quadrature points.</p>
<p>This function computes the values of the forcing function at the quadrature points
and assigns them to the <code>forcing_at_quad</code> attribute of the FE2D_Cell object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>forcing_function</code>
            </td>
            <td>
                  <code>callable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The forcing function to be integrated</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The final shape of <code>forcing_at_quad</code> will be N_shape_functions x 1.</li>
<li>This function is for backward compatibility with old code and currently assigns
  the values as zeros. The actual calculation is performed in the fespace class.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="k">def</span> <span class="nf">assign_forcing_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">forcing_function</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    Assigns the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    This function computes the values of the forcing function at the quadrature points</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    and assigns them to the `forcing_at_quad` attribute of the FE2D_Cell object.</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        forcing_function (callable): The forcing function to be integrated</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        None</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        - The final shape of `forcing_at_quad` will be N_shape_functions x 1.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        - This function is for backward compatibility with old code and currently assigns</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">          the values as zeros. The actual calculation is performed in the fespace class.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="c1"># get number of shape functions</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="n">n_shape_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">num_shape_functions</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="c1"># Loop over all the basis functions and compute the integral</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">f_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_shape_functions</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="c1"># The above code is for backward compatibility with old code. this function will just assign the values as zeros</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="c1"># the actual calculation is performed in the fespace class</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="c1"># for i in range(n_shape_functions):</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="c1">#     val = 0</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="c1">#     for q in range(self.basis_at_quad.shape[1]):</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="c1">#         x = self.quad_actual_coordinates[q, 0]</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="c1">#         y = self.quad_actual_coordinates[q, 1]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="c1">#         # print(&quot;f_values[q] = &quot;,f_values[q])</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="c1">#         # the JAcobian and the quadrature weights are pre multiplied to the basis functions</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="c1">#         val +=  ( self.basis_at_quad[i, q] ) * self.forcing_function(x, y)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="c1">#         # print(&quot;val = &quot;, val)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="c1">#     f_integral[i] = val</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="n">f_integral</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_quad_weights_and_jacobian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_quad_weights_and_jacobian</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the quadrature weights and the Jacobian of the transformation.</p>
<p>This method calculates and assigns the quadrature weights and the Jacobian of the transformation
for the current cell. The quadrature weights are multiplied by the flattened Jacobian array
and stored in the <code>mult</code> attribute of the class.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span> <span class="nf">assign_quad_weights_and_jacobian</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Assigns the quadrature weights and the Jacobian of the transformation.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    This method calculates and assigns the quadrature weights and the Jacobian of the transformation</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    for the current cell. The quadrature weights are multiplied by the flattened Jacobian array</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    and stored in the `mult` attribute of the class.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        None</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        None</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mult</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">jacobian</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_quadrature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_quadrature</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the quadrature points and weights based on the cell type and the quadrature order.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="k">def</span> <span class="nf">assign_quadrature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Assigns the quadrature points and weights based on the cell type and the quadrature order.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        None</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        None</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_setup</span><span class="o">.</span><span class="n">assign_quadrature_rules</span><span class="p">()</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.FE2D_Cell.assign_quadrature_coordinates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">assign_quadrature_coordinates</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the actual coordinates of the quadrature points.</p>
<p>This method calculates the actual coordinates of the quadrature points based on the given Xi and Eta values.
The Xi and Eta values are obtained from the <code>quad_xi</code> and <code>quad_eta</code> attributes of the class.
The calculated coordinates are stored in the <code>quad_actual_coordinates</code> attribute as a NumPy array.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fe2d_cell.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="k">def</span> <span class="nf">assign_quadrature_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">    Assigns the actual coordinates of the quadrature points.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    This method calculates the actual coordinates of the quadrature points based on the given Xi and Eta values.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    The Xi and Eta values are obtained from the `quad_xi` and `quad_eta` attributes of the class.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    The calculated coordinates are stored in the `quad_actual_coordinates` attribute as a NumPy array.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        None</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        None</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">actual_co_ord</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quad_xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quad_eta</span><span class="p">):</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">actual_co_ord</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fetransformation</span><span class="o">.</span><span class="n">get_original_from_ref</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">))</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_actual_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">actual_co_ord</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace" class="doc doc-heading">
            <code>Fespace</code>


</h2>


    <div class="doc doc-contents ">


        <p>Abstract base class defining the interface for finite element spaces.</p>
<p>This class provides the foundation for implementing finite element spaces,
including mesh handling, element operations, and solution computations.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.mesh">mesh</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mesh object containing geometric information</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.cells">cells</span></code></td>
            <td>
                  <code>ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of cell indices</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.boundary_points">boundary_points</span></code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of boundary point information</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.cell_type">cell_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of finite element cell</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.fe_order">fe_order</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of finite element approximation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.fe_type">fe_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of finite element basis</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.quad_order">quad_order</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of quadrature rule</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.quad_type">quad_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of quadrature formula</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.fe_transformation_type">fe_transformation_type</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of geometric transformation</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.bound_function_dict">bound_function_dict</span></code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of boundary condition functions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.bound_condition_dict">bound_condition_dict</span></code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of boundary condition types</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.forcing_function">forcing_function</span></code></td>
            <td>
                  <code>callable</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source term function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.output_path">output_path</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path for output files</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>class MyFespace(Fespace):
...     def set_finite_elements(self):
...         # Implementation
...         pass
...     def generate_dirichlet_boundary_data(self):
...         # Implementation
...         pass
...     # Implement other abstract methods</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>All coordinate transformations must be implemented</li>
<li>Shape function values and gradients are available in both
reference and physical spaces</li>
<li>Supports both internal and external sensor data for
inverse problems</li>
<li>Boundary conditions must be properly specified through
the boundary dictionaries</li>
</ul>
</details>





              <details class="quote">
                <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">class</span> <span class="nc">Fespace</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Abstract base class defining the interface for finite element spaces.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    This class provides the foundation for implementing finite element spaces,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    including mesh handling, element operations, and solution computations.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        mesh: Mesh object containing geometric information</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        cells (ndarray): Array of cell indices</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        boundary_points (dict): Dictionary of boundary point information</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        cell_type (str): Type of finite element cell</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        fe_order (int): Order of finite element approximation</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        fe_type (str): Type of finite element basis</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        quad_order (int): Order of quadrature rule</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        quad_type (str): Type of quadrature formula</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        fe_transformation_type (str): Type of geometric transformation</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        bound_function_dict (dict): Dictionary of boundary condition functions</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        bound_condition_dict (dict): Dictionary of boundary condition types</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        forcing_function (callable): Source term function</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        output_path (str): Path for output files</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        &gt;&gt;&gt; class MyFespace(Fespace):</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        ...     def set_finite_elements(self):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        ...         # Implementation</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        ...         pass</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        ...     def generate_dirichlet_boundary_data(self):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        ...         # Implementation</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        ...         pass</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ...     # Implement other abstract methods</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        - All coordinate transformations must be implemented</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        - Shape function values and gradients are available in both</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        reference and physical spaces</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        - Supports both internal and external sensor data for</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        inverse problems</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        - Boundary conditions must be properly specified through</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        the boundary dictionaries</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">mesh</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">cells</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">boundary_points</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">cell_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">fe_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">fe_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">quad_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">quad_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">fe_transformation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">bound_function_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">bound_condition_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        The constructor of the Fespace2D class.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">            mesh: The mesh object.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            cells: The cells of the mesh.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            boundary_points: The boundary points of the mesh.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            cell_type: The type of the cell.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            fe_order: The order of the finite element.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            fe_type: The type of the finite element.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            quad_order: The order of the quadrature.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            quad_type: The type of the quadrature.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            fe_transformation_type: The type of the finite element transformation.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            bound_function_dict: The dictionary of the boundary functions.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            bound_condition_dict: The dictionary of the boundary conditions.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            forcing_function: The forcing function.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            output_path: The path to the output directory.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            None</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span> <span class="o">=</span> <span class="n">boundary_points</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="n">cells</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span> <span class="o">=</span> <span class="n">cell_type</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span> <span class="o">=</span> <span class="n">fe_order</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span> <span class="o">=</span> <span class="n">fe_type</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span> <span class="o">=</span> <span class="n">quad_order</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span> <span class="o">=</span> <span class="n">quad_type</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation_type</span> <span class="o">=</span> <span class="n">fe_transformation_type</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bound_function_dict</span> <span class="o">=</span> <span class="n">bound_function_dict</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bound_condition_dict</span> <span class="o">=</span> <span class="n">bound_condition_dict</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span> <span class="o">=</span> <span class="n">forcing_function</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">def</span> <span class="nf">set_finite_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        Assigns the finite elements to each cell.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        This method initializes the finite element objects for each cell in the mesh.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        It creates an instance of the `FE2D_Cell` class for each cell, passing the necessary parameters.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        The finite element objects store information about the basis functions, gradients, Jacobians,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        quadrature points, weights, actual coordinates, and forcing functions associated with each cell.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        After initializing the finite element objects, this method prints the shape details of various matrices</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        and updates the total number of degrees of freedom (dofs) for the entire mesh.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            None</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            None</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">def</span> <span class="nf">generate_dirichlet_boundary_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        Generate Dirichlet boundary data.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        This function returns the boundary points and their corresponding values.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            None</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            np.ndarray: The boundary points and their values.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            The boundary points and values are stored in the `boundary_points` attribute of the `Fespace` object.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">def</span> <span class="nf">get_shape_function_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Get the actual values of the shape functions on a given cell.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            np.ndarray: An array containing the actual values of the shape functions.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        Get the gradient of the shape function with respect to the x-coordinate.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            np.ndarray: An array containing the gradient of the shape function with respect to the x-coordinate.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_x_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        Get the gradient of the shape function with respect to the x-coordinate on the reference element.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            np.ndarray: An array containing the gradient of the shape function with respect to the x-coordinate on the reference element.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Get the gradient of the shape function with respect to y at the given cell index.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            np.ndarray: An array containing the gradient of the shape function with respect to y.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_y_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        Get the gradient of the shape function with respect to y at the reference element.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            np.ndarray: An array containing the gradient of the shape function with respect to y at the reference element.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            This function returns the gradient of the shape function with respect to y at the reference element</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            for a given cell. The shape function gradient values are stored in the `basis_grady_at_quad_ref` array</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">            of the corresponding finite element cell. The `cell_index` parameter specifies the index of the cell</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            for which the shape function gradient is required. If the `cell_index` is greater than the total number</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            of cells, a `ValueError` is raised. The returned gradient values are copied from the `basis_grady_at_quad_ref` array to ensure immutability.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">def</span> <span class="nf">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        Get the actual coordinates of the quadrature points for a given cell.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">            np.ndarray: An array containing the actual coordinates of the quadrature points.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="k">def</span> <span class="nf">get_forcing_function_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        Get the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            np.ndarray: An array containing the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            This function computes the forcing function values at the quadrature points for a given cell.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            It loops over all the basis functions and computes the integral using the actual coordinates</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            and the basis functions at the quadrature points. The resulting values are stored in the</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            `forcing_at_quad` attribute of the corresponding `fe_cell` object. The forcing function is evaluated using the `forcing_function` method of the `fe_cell`</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            object.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">def</span> <span class="nf">get_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exact_solution</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Obtain sensor data (actual solution) at random points.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            exact_solution (ndarray): The exact solution values.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            num_points (int): The number of points to sample from the domain.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            np.ndarray: The sensor data at the given points.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            This method is used in the inverse problem to obtain the sensor data at random points within the domain. Currently, it only works for problems with an analytical solution.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            Methodologies to obtain sensor data for problems from a file are not implemented yet.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            It is also not implemented for external or complex meshes.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">def</span> <span class="nf">get_sensor_data_external</span><span class="p">(</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        This method is used to obtain the sensor data from an external file when there is no analytical solution available.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            exact_sol: The exact solution values.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            num_points: The number of points to sample from the domain.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            file_name: The name of the file containing the sensor data.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            np.ndarray: The sensor data at the given points based on the external file.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">boundary_points</span><span class="p">,</span> <span class="n">cell_type</span><span class="p">,</span> <span class="n">fe_order</span><span class="p">,</span> <span class="n">fe_type</span><span class="p">,</span> <span class="n">quad_order</span><span class="p">,</span> <span class="n">quad_type</span><span class="p">,</span> <span class="n">fe_transformation_type</span><span class="p">,</span> <span class="n">bound_function_dict</span><span class="p">,</span> <span class="n">bound_condition_dict</span><span class="p">,</span> <span class="n">forcing_function</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The constructor of the Fespace2D class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mesh</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mesh object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cells</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cells of the mesh.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boundary_points</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boundary points of the mesh.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cell_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_order</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The order of the finite element.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the finite element.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quad_order</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The order of the quadrature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quad_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the quadrature.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_transformation_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the finite element transformation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bound_function_dict</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary of the boundary functions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bound_condition_dict</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary of the boundary conditions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>forcing_function</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The forcing function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the output directory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">mesh</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">cells</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">boundary_points</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">cell_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">fe_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">fe_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">quad_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">quad_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">fe_transformation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">bound_function_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">bound_condition_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    The constructor of the Fespace2D class.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        mesh: The mesh object.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        cells: The cells of the mesh.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        boundary_points: The boundary points of the mesh.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        cell_type: The type of the cell.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        fe_order: The order of the finite element.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        fe_type: The type of the finite element.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        quad_order: The order of the quadrature.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        quad_type: The type of the quadrature.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        fe_transformation_type: The type of the finite element transformation.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        bound_function_dict: The dictionary of the boundary functions.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        bound_condition_dict: The dictionary of the boundary conditions.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        forcing_function: The forcing function.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        output_path: The path to the output directory.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        None</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span> <span class="o">=</span> <span class="n">boundary_points</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="n">cells</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span> <span class="o">=</span> <span class="n">cell_type</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span> <span class="o">=</span> <span class="n">fe_order</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span> <span class="o">=</span> <span class="n">fe_type</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span> <span class="o">=</span> <span class="n">quad_order</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span> <span class="o">=</span> <span class="n">quad_type</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation_type</span> <span class="o">=</span> <span class="n">fe_transformation_type</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bound_function_dict</span> <span class="o">=</span> <span class="n">bound_function_dict</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bound_condition_dict</span> <span class="o">=</span> <span class="n">bound_condition_dict</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span> <span class="o">=</span> <span class="n">forcing_function</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.generate_dirichlet_boundary_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_dirichlet_boundary_data</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Generate Dirichlet boundary data.</p>
<p>This function returns the boundary points and their corresponding values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The boundary points and their values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The boundary points and values are stored in the <code>boundary_points</code> attribute of the <code>Fespace</code> object.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="k">def</span> <span class="nf">generate_dirichlet_boundary_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Generate Dirichlet boundary data.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    This function returns the boundary points and their corresponding values.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        None</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        np.ndarray: The boundary points and their values.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        The boundary points and values are stored in the `boundary_points` attribute of the `Fespace` object.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_forcing_function_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_forcing_function_values</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the forcing function values at the quadrature points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the forcing function values at the quadrature points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This function computes the forcing function values at the quadrature points for a given cell.
It loops over all the basis functions and computes the integral using the actual coordinates
and the basis functions at the quadrature points. The resulting values are stored in the
<code>forcing_at_quad</code> attribute of the corresponding <code>fe_cell</code> object. The forcing function is evaluated using the <code>forcing_function</code> method of the <code>fe_cell</code>
object.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="k">def</span> <span class="nf">get_forcing_function_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    Get the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        np.ndarray: An array containing the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        This function computes the forcing function values at the quadrature points for a given cell.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        It loops over all the basis functions and computes the integral using the actual coordinates</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        and the basis functions at the quadrature points. The resulting values are stored in the</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        `forcing_at_quad` attribute of the corresponding `fe_cell` object. The forcing function is evaluated using the `forcing_function` method of the `fe_cell`</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        object.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_quadrature_actual_coordinates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the actual coordinates of the quadrature points for a given cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the actual coordinates of the quadrature points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span> <span class="nf">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    Get the actual coordinates of the quadrature points for a given cell.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        np.ndarray: An array containing the actual coordinates of the quadrature points.</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_sensor_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sensor_data</span><span class="p">(</span><span class="n">exact_solution</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Obtain sensor data (actual solution) at random points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exact_solution</code>
            </td>
            <td>
                  <code>ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact solution values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of points to sample from the domain.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The sensor data at the given points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This method is used in the inverse problem to obtain the sensor data at random points within the domain. Currently, it only works for problems with an analytical solution.
Methodologies to obtain sensor data for problems from a file are not implemented yet.
It is also not implemented for external or complex meshes.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="k">def</span> <span class="nf">get_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exact_solution</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    Obtain sensor data (actual solution) at random points.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        exact_solution (ndarray): The exact solution values.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        num_points (int): The number of points to sample from the domain.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        np.ndarray: The sensor data at the given points.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        This method is used in the inverse problem to obtain the sensor data at random points within the domain. Currently, it only works for problems with an analytical solution.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        Methodologies to obtain sensor data for problems from a file are not implemented yet.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        It is also not implemented for external or complex meshes.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_sensor_data_external" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sensor_data_external</span><span class="p">(</span><span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>This method is used to obtain the sensor data from an external file when there is no analytical solution available.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exact_sol</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact solution values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of points to sample from the domain.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the file containing the sensor data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The sensor data at the given points based on the external file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="k">def</span> <span class="nf">get_sensor_data_external</span><span class="p">(</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    This method is used to obtain the sensor data from an external file when there is no analytical solution available.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        exact_sol: The exact solution values.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        num_points: The number of points to sample from the domain.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        file_name: The name of the file containing the sensor data.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        np.ndarray: The sensor data at the given points based on the external file.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_x" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_x</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to the x-coordinate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the gradient of the shape function with respect to the x-coordinate.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    Get the gradient of the shape function with respect to the x-coordinate.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        np.ndarray: An array containing the gradient of the shape function with respect to the x-coordinate.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_x_ref" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_x_ref</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to the x-coordinate on the reference element.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the gradient of the shape function with respect to the x-coordinate on the reference element.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_x_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    Get the gradient of the shape function with respect to the x-coordinate on the reference element.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        np.ndarray: An array containing the gradient of the shape function with respect to the x-coordinate on the reference element.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_y</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to y at the given cell index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the gradient of the shape function with respect to y.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Get the gradient of the shape function with respect to y at the given cell index.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        np.ndarray: An array containing the gradient of the shape function with respect to y.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_grad_y_ref" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_y_ref</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to y at the reference element.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the gradient of the shape function with respect to y at the reference element.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This function returns the gradient of the shape function with respect to y at the reference element
for a given cell. The shape function gradient values are stored in the <code>basis_grady_at_quad_ref</code> array
of the corresponding finite element cell. The <code>cell_index</code> parameter specifies the index of the cell
for which the shape function gradient is required. If the <code>cell_index</code> is greater than the total number
of cells, a <code>ValueError</code> is raised. The returned gradient values are copied from the <code>basis_grady_at_quad_ref</code> array to ensure immutability.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_y_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    Get the gradient of the shape function with respect to y at the reference element.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        np.ndarray: An array containing the gradient of the shape function with respect to y at the reference element.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        This function returns the gradient of the shape function with respect to y at the reference element</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        for a given cell. The shape function gradient values are stored in the `basis_grady_at_quad_ref` array</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        of the corresponding finite element cell. The `cell_index` parameter specifies the index of the cell</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        for which the shape function gradient is required. If the `cell_index` is greater than the total number</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        of cells, a `ValueError` is raised. The returned gradient values are copied from the `basis_grady_at_quad_ref` array to ensure immutability.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.get_shape_function_val" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_val</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Get the actual values of the shape functions on a given cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the actual values of the shape functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="k">def</span> <span class="nf">get_shape_function_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Get the actual values of the shape functions on a given cell.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        np.ndarray: An array containing the actual values of the shape functions.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace.set_finite_elements" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_finite_elements</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the finite elements to each cell.</p>
<p>This method initializes the finite element objects for each cell in the mesh.
It creates an instance of the <code>FE2D_Cell</code> class for each cell, passing the necessary parameters.
The finite element objects store information about the basis functions, gradients, Jacobians,
quadrature points, weights, actual coordinates, and forcing functions associated with each cell.</p>
<p>After initializing the finite element objects, this method prints the shape details of various matrices
and updates the total number of degrees of freedom (dofs) for the entire mesh.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="k">def</span> <span class="nf">set_finite_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Assigns the finite elements to each cell.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    This method initializes the finite element objects for each cell in the mesh.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    It creates an instance of the `FE2D_Cell` class for each cell, passing the necessary parameters.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    The finite element objects store information about the basis functions, gradients, Jacobians,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    quadrature points, weights, actual coordinates, and forcing functions associated with each cell.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    After initializing the finite element objects, this method prints the shape details of various matrices</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    and updates the total number of degrees of freedom (dofs) for the entire mesh.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        None</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        None</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D" class="doc doc-heading">
            <code>Fespace2D</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="scirex.core.sciml.fe.fespace.Fespace" href="../../../fe/fespace/#scirex.core.sciml.fe.fespace.Fespace">Fespace</a></code></p>


        <p>Represents a finite element space in 2D. This class provides functionality for handling 2D finite element spaces,
including mesh generation, basis function evaluation, and boundary condition handling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mesh</code>
            </td>
            <td>
                  <code><span title="meshio.Mesh">Mesh</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mesh object containing the mesh information.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cells</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The cell information from the mesh.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boundary_points</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boundary points information from the mesh.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cell_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the cell (e.g., 'quadrilateral').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_order</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The order of the finite element basis functions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the finite element basis functions (e.g., 'legendre').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quad_order</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The order of the quadrature rule.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>quad_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the quadrature rule (e.g., 'gauss-legendre').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fe_transformation_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of the finite element transformation (e.g., 'affine').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bound_function_dict</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the boundary functions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bound_condition_dict</code>
            </td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the boundary conditions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>forcing_function</code>
            </td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The forcing function for the problem.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to save the output files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>generate_mesh_plot</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to generate the mesh plot (default: False).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">class</span> <span class="nc">Fespace2D</span><span class="p">(</span><span class="n">Fespace</span><span class="p">):</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Represents a finite element space in 2D. This class provides functionality for handling 2D finite element spaces,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    including mesh generation, basis function evaluation, and boundary condition handling.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        mesh (meshio.Mesh): The mesh object containing the mesh information.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        cells (np.ndarray): The cell information from the mesh.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        boundary_points (dict): The boundary points information from the mesh.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        cell_type (str): The type of the cell (e.g., &#39;quadrilateral&#39;).</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        fe_order (int): The order of the finite element basis functions.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        fe_type (str): The type of the finite element basis functions (e.g., &#39;legendre&#39;).</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        quad_order (int): The order of the quadrature rule.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        quad_type (str): The type of the quadrature rule (e.g., &#39;gauss-legendre&#39;).</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        fe_transformation_type (str): The type of the finite element transformation (e.g., &#39;affine&#39;).</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        bound_function_dict (dict): A dictionary containing the boundary functions.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        bound_condition_dict (dict): A dictionary containing the boundary conditions.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        forcing_function (function): The forcing function for the problem.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        output_path (str): The path to save the output files.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        generate_mesh_plot (bool): Flag to generate the mesh plot (default: False).</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        ValueError: If the cell type is not supported.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        None</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">mesh</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">cells</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">boundary_points</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">cell_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">fe_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">fe_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">quad_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">quad_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="n">fe_transformation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="n">bound_function_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="n">bound_condition_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">generate_mesh_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        The constructor of the Fespace2D class.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="c1"># call the constructor of the parent class</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">cells</span><span class="o">=</span><span class="n">cells</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="n">boundary_points</span><span class="o">=</span><span class="n">boundary_points</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="n">cell_type</span><span class="o">=</span><span class="n">cell_type</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="n">fe_order</span><span class="o">=</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="n">fe_type</span><span class="o">=</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="n">quad_order</span><span class="o">=</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">quad_type</span><span class="o">=</span><span class="n">quad_type</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="n">fe_transformation_type</span><span class="o">=</span><span class="n">fe_transformation_type</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="n">bound_function_dict</span><span class="o">=</span><span class="n">bound_function_dict</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="n">bound_condition_dict</span><span class="o">=</span><span class="n">bound_condition_dict</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="n">forcing_function</span><span class="o">=</span><span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">output_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span> <span class="o">==</span> <span class="s2">&quot;triangle&quot;</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="s2">&quot;Triangle Mesh is not supported yet&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="p">)</span>  <span class="c1"># added by thivin - to remove support for triangular mesh</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_mesh_plot</span> <span class="o">=</span> <span class="n">generate_mesh_plot</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="c1"># to be calculated in the plot function</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_boundary_dofs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="c1"># to be calculated on get_boundary_data_dirichlet function</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dirichlet_dofs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="c1"># get the number of cells</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="c1"># Function which assigns the fe_cell for each cell</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_finite_elements</span><span class="p">()</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="c1"># generate the plot of the mesh</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_mesh_plot</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generate_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="c1"># self.generate_plot(self.output_path)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="c1"># Obtain boundary Data</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dirichlet_boundary_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_dirichlet_boundary_data</span><span class="p">()</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="s2">&quot;Number of Cells&quot;</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="s2">&quot;Number of Quadrature Points&quot;</span><span class="p">,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="s2">&quot;Number of Dirichlet Boundary Points&quot;</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="s2">&quot;Quadrature Order&quot;</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="s2">&quot;fe Order&quot;</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="s2">&quot;fe Type&quot;</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="s2">&quot;fe Transformation Type&quot;</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="p">]</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">total_dirichlet_dofs</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation_type</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="p">]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="c1"># print the table</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">print_table</span><span class="p">(</span><span class="s2">&quot;fe Space Information&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Property&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">],</span> <span class="n">title</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">def</span> <span class="nf">set_finite_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        Assigns the finite elements to each cell.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        This method initializes the finite element objects for each cell in the mesh.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        It creates an instance of the `FE2D_Cell` class for each cell, passing the necessary parameters.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        The finite element objects store information about the basis functions, gradients, Jacobians,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        quadrature points, weights, actual coordinates, and forcing functions associated with each cell.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        After initializing the finite element objects, this method prints the shape details of various matrices</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        and updates the total number of degrees of freedom (dofs) for the entire mesh.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        :return: None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="n">total</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Fe2D_cell Setup&quot;</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;cells_assembled&quot;</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="n">bar_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{l_bar}{bar:40}{r_bar}{bar:-10b}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">colour</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">dof</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                <span class="n">FE2D_Cell</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation_type</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                <span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="c1"># obtain the shape of the basis function (n_test, N_quad)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">dof</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">progress_bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="c1"># print the Shape details of all the matrices from cell 0 using print_table function</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">title</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="s2">&quot;Shape function Matrix Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="s2">&quot;Shape function Gradient Matrix Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="s2">&quot;Jacobian Matrix Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="s2">&quot;Quadrature Points Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="s2">&quot;Quadrature Weights Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="s2">&quot;Quadrature Actual Coordinates Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="s2">&quot;Forcing Function Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="p">]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">jacobian</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quad_xi</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quad_weight</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="p">]</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">print_table</span><span class="p">(</span><span class="s2">&quot;fe Matrix Shapes&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">,</span> <span class="s2">&quot;Shape&quot;</span><span class="p">],</span> <span class="n">title</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="c1"># update the total number of dofs</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span> <span class="o">=</span> <span class="n">dof</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">def</span> <span class="nf">generate_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        Generate a plot of the mesh.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            output_path (str): The path to save the output files.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            None</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">total_quad</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="s2">&quot;.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="s2">&quot;,&quot;</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="s2">&quot;x&quot;</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="s2">&quot;+&quot;</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="s2">&quot;P&quot;</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="s2">&quot;s&quot;</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="s2">&quot;D&quot;</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="s2">&quot;d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="s2">&quot;^&quot;</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="s2">&quot;v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="s2">&quot;p&quot;</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="s2">&quot;h&quot;</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="s2">&quot;H&quot;</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="p">]</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Generating the plot of the mesh&quot;</span><span class="p">)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="c1"># Plot the mesh</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="c1"># label flag ( to add the label only once)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">label_set</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="c1"># plot every cell as a quadrilateral</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="c1"># loop over all the cells</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">):</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="c1"># get the coordinates of the cell</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cell_coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cell_coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="c1"># add the first point to the end of the array</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="c1"># plot the quadrature points</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">x_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="n">y_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">total_quad</span> <span class="o">+=</span> <span class="n">x_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">label_set</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                    <span class="n">x_quad</span><span class="p">,</span> <span class="n">y_quad</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Quad Pts&quot;</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="n">label_set</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_quad</span><span class="p">,</span> <span class="n">y_quad</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span> <span class="o">=</span> <span class="n">total_quad</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="n">bound_dof</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="c1"># plot the boundary points</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="c1"># loop over all the boundary tags</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">bound_id</span><span class="p">,</span> <span class="n">bound_pts</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="c1"># get the coordinates of the boundary points</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">bound_pts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">bound_pts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="c1"># add the first point to the end of the array</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="n">bound_dof</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bd-id : </span><span class="si">{</span><span class="n">bound_id</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_boundary_dofs</span> <span class="o">=</span> <span class="n">bound_dof</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">))</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;mesh.png&quot;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;mesh.svg&quot;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="c1"># print the total number of quadrature points</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plots generated&quot;</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of cells = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of quadrature points = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of boundary points = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_boundary_dofs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">def</span> <span class="nf">generate_dirichlet_boundary_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        Generate Dirichlet boundary data. This function returns the boundary points and their corresponding values.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            None</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            tuple: The boundary points and their values as numpy arrays.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="k">for</span> <span class="n">bound_id</span><span class="p">,</span> <span class="n">bound_pts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="c1"># get the coordinates of the boundary points</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">bound_pts</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="n">pt_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt_new</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">bound_function_dict</span><span class="p">[</span><span class="n">bound_id</span><span class="p">](</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of Dirichlet boundary points = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dirichlet_dofs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Shape of Dirichlet-X = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Shape of Y = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="k">def</span> <span class="nf">generate_dirichlet_boundary_data_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        Generate the boundary data vector for the Dirichlet boundary condition. This function returns the boundary points and their corresponding values for a specific component.</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            component (int): The component of the boundary data vector.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">            tuple: The boundary points and their values as numpy arrays.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="k">for</span> <span class="n">bound_id</span><span class="p">,</span> <span class="n">bound_pts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>            <span class="c1"># get the coordinates of the boundary points</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">bound_pts</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>                <span class="n">pt_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt_new</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">bound_function_dict</span><span class="p">[</span><span class="n">bound_id</span><span class="p">](</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="n">component</span><span class="p">],</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="k">def</span> <span class="nf">get_shape_function_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        Get the actual values of the shape functions on a given cell.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Get the gradient of the shape function with respect to the x-coordinate.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_x_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        Get the gradient of the shape function with respect to the x-coordinate on the reference element.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">            np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_gradx_at_quad_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        Get the gradient of the shape function with respect to y at the given cell index.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">            np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_grady_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="k">def</span> <span class="nf">get_shape_function_grad_y_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">        Get the gradient of the shape function with respect to y at the reference element.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">            np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            This function returns the gradient of the shape function with respect to y at the reference element</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            for a given cell. The shape function gradient values are stored in the `basis_grady_at_quad_ref` array</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">            of the corresponding finite element cell. The `cell_index` parameter specifies the index of the cell</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">            for which the shape function gradient is required. If the `cell_index` is greater than the total number</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">            of cells, a `ValueError` is raised. The returned gradient values are copied from the `basis_grady_at_quad_ref` array to ensure immutability.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="p">)</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_grady_at_quad_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="k">def</span> <span class="nf">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        Get the actual coordinates of the quadrature points for a given cell.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">            np.ndarray: An array containing the actual coordinates of the quadrature points.</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>            <span class="p">)</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="k">def</span> <span class="nf">get_quadrature_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        Return the quadrature weights for a given cell.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            cell_index (int): The index of the cell for which the quadrature weights are needed.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            np.ndarray: The quadrature weights for the given cell  of dimension (N_Quad_Points, 1).</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">            ValueError: If cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">mult</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="k">def</span> <span class="nf">get_forcing_function_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">        Get the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">            np.ndarray: The forcing function values at the quadrature points.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">            This function computes the forcing function values at the quadrature points for a given cell.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">            It loops over all the basis functions and computes the integral using the actual coordinates</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">            and the basis functions at the quadrature points. The resulting values are stored in the</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">            `forcing_at_quad` attribute of the corresponding `fe_cell` object.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="p">)</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>        <span class="c1"># Changed by Thivin: To assemble the forcing function at the quadrature points here in the fespace</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="c1"># so that it can be used to handle multiple dimensions on a vector valud problem</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="c1"># get number of shape functions</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="n">n_shape_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">num_shape_functions</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="c1"># Loop over all the basis functions and compute the integral</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="n">f_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_shape_functions</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_shape_functions</span><span class="p">):</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                <span class="c1"># print(&quot;f_values[q] = &quot;,f_values[q])</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                <span class="c1"># the Jacobian and the quadrature weights are pre multiplied to the basis functions</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                <span class="n">val</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                    <span class="n">cell_index</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                <span class="p">]</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                <span class="c1"># print(&quot;val = &quot;, val)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="n">f_integral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="n">f_integral</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>    <span class="k">def</span> <span class="nf">get_forcing_function_values_vector</span><span class="p">(</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        This function will return the forcing function values at the quadrature points</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        based on the Component of the RHS Needed, for vector valued problems</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">            cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">            component (int): The component of the forcing function.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">            np.ndarray: The forcing function values at the quadrature points.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">            ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>                <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="c1"># get the coordinates</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="c1"># compute the forcing function values</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">f_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="n">component</span><span class="p">]</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="c1"># compute the integral</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">f_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">*</span> <span class="n">f_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="n">f_integral</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="k">def</span> <span class="nf">get_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exact_solution</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        Obtain sensor data (actual solution) at random points.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">        This method is used in the inverse problem to obtain the sensor data at random points within the domain.</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">        Currently, it only works for problems with an analytical solution.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">        Methodologies to obtain sensor data for problems from a file are not implemented yet.</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">        It is also not implemented for external or complex meshes.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">            exact_solution (function): The exact solution function.</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">            num_points (int): The number of points to sample.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">            Tuple: A tuple containing two arrays: sensor points and the exact solution values.</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="c1"># generate random points within the bounds of the domain</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>        <span class="c1"># get the bounds of the domain</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>        <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="n">y_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="n">y_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="c1"># sample n random points within the bounds of the domain</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="c1"># Generate points in the unit square</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="n">num_internal_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_points</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="n">num_internal_points</span><span class="p">)</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">*</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="c1"># get the exact solution at the points</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="n">exact_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="c1"># print the shape of the points and the exact solution</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Number of sensor points = </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Shape of sensor points = </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="c1"># plot the points</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sensor Points&quot;</span><span class="p">)</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;sensor_points.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">exact_sol</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">def</span> <span class="nf">get_sensor_data_external</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">        This method is used to obtain the sensor data from an external file.</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">            exact_sol (function): The exact solution function.</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">            num_points (int): The number of points to sample.</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">            file_name (str): The name of the file containing the sensor data.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">            Tuple: A tuple containing two arrays: sensor points and the exact solution values.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">            This method reads the sensor data from a file and samples `num_points` from the data.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">            The sensor data is then returned as a tuple containing the sensor points and the exact solution values.</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="c1"># use pandas to read the file</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>        <span class="n">exact_sol</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="c1"># now sample num_points from the data</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_points</span><span class="p">)</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="n">exact_sol</span> <span class="o">=</span> <span class="n">exact_sol</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="c1"># stack them together</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">exact_sol</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">boundary_points</span><span class="p">,</span> <span class="n">cell_type</span><span class="p">,</span> <span class="n">fe_order</span><span class="p">,</span> <span class="n">fe_type</span><span class="p">,</span> <span class="n">quad_order</span><span class="p">,</span> <span class="n">quad_type</span><span class="p">,</span> <span class="n">fe_transformation_type</span><span class="p">,</span> <span class="n">bound_function_dict</span><span class="p">,</span> <span class="n">bound_condition_dict</span><span class="p">,</span> <span class="n">forcing_function</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">generate_mesh_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>The constructor of the Fespace2D class.</p>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">mesh</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">cells</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">boundary_points</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">cell_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">fe_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">fe_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">quad_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">quad_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">fe_transformation_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">bound_function_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">bound_condition_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">generate_mesh_plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    The constructor of the Fespace2D class.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="c1"># call the constructor of the parent class</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">cells</span><span class="o">=</span><span class="n">cells</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">boundary_points</span><span class="o">=</span><span class="n">boundary_points</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">cell_type</span><span class="o">=</span><span class="n">cell_type</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">fe_order</span><span class="o">=</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">fe_type</span><span class="o">=</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">quad_order</span><span class="o">=</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">quad_type</span><span class="o">=</span><span class="n">quad_type</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">fe_transformation_type</span><span class="o">=</span><span class="n">fe_transformation_type</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">bound_function_dict</span><span class="o">=</span><span class="n">bound_function_dict</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">bound_condition_dict</span><span class="o">=</span><span class="n">bound_condition_dict</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">forcing_function</span><span class="o">=</span><span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">output_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span> <span class="o">==</span> <span class="s2">&quot;triangle&quot;</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="s2">&quot;Triangle Mesh is not supported yet&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="p">)</span>  <span class="c1"># added by thivin - to remove support for triangular mesh</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">generate_mesh_plot</span> <span class="o">=</span> <span class="n">generate_mesh_plot</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="c1"># to be calculated in the plot function</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_boundary_dofs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="c1"># to be calculated on get_boundary_data_dirichlet function</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_dirichlet_dofs</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="c1"># get the number of cells</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1"># Function which assigns the fe_cell for each cell</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">set_finite_elements</span><span class="p">()</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="c1"># generate the plot of the mesh</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_mesh_plot</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># self.generate_plot(self.output_path)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="c1"># Obtain boundary Data</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dirichlet_boundary_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_dirichlet_boundary_data</span><span class="p">()</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">title</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="s2">&quot;Number of Cells&quot;</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="s2">&quot;Number of Quadrature Points&quot;</span><span class="p">,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="s2">&quot;Number of Dirichlet Boundary Points&quot;</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="s2">&quot;Quadrature Order&quot;</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="s2">&quot;fe Order&quot;</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="s2">&quot;fe Type&quot;</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="s2">&quot;fe Transformation Type&quot;</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="p">]</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_dirichlet_dofs</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation_type</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="p">]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="c1"># print the table</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">print_table</span><span class="p">(</span><span class="s2">&quot;fe Space Information&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Property&quot;</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">],</span> <span class="n">title</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.generate_dirichlet_boundary_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_dirichlet_boundary_data</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate Dirichlet boundary data. This function returns the boundary points and their corresponding values.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boundary points and their values as numpy arrays.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="k">def</span> <span class="nf">generate_dirichlet_boundary_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    Generate Dirichlet boundary data. This function returns the boundary points and their corresponding values.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        None</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        tuple: The boundary points and their values as numpy arrays.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">for</span> <span class="n">bound_id</span><span class="p">,</span> <span class="n">bound_pts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="c1"># get the coordinates of the boundary points</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">bound_pts</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">pt_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt_new</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">bound_function_dict</span><span class="p">[</span><span class="n">bound_id</span><span class="p">](</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of Dirichlet boundary points = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_dirichlet_dofs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Shape of Dirichlet-X = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Shape of Y = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.generate_dirichlet_boundary_data_vector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_dirichlet_boundary_data_vector</span><span class="p">(</span><span class="n">component</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate the boundary data vector for the Dirichlet boundary condition. This function returns the boundary points and their corresponding values for a specific component.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>component</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The component of the boundary data vector.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>tuple</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boundary points and their values as numpy arrays.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="k">def</span> <span class="nf">generate_dirichlet_boundary_data_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    Generate the boundary data vector for the Dirichlet boundary condition. This function returns the boundary points and their corresponding values for a specific component.</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        component (int): The component of the boundary data vector.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        tuple: The boundary points and their values as numpy arrays.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">for</span> <span class="n">bound_id</span><span class="p">,</span> <span class="n">bound_pts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="c1"># get the coordinates of the boundary points</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">bound_pts</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">pt_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pt_new</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">bound_function_dict</span><span class="p">[</span><span class="n">bound_id</span><span class="p">](</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="n">component</span><span class="p">],</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.generate_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_plot</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate a plot of the mesh.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to save the output files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="k">def</span> <span class="nf">generate_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    Generate a plot of the mesh.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        output_path (str): The path to save the output files.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        None</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="n">total_quad</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="s2">&quot;o&quot;</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="s2">&quot;.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="s2">&quot;,&quot;</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="s2">&quot;x&quot;</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="s2">&quot;+&quot;</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="s2">&quot;P&quot;</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="s2">&quot;s&quot;</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="s2">&quot;D&quot;</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="s2">&quot;d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="s2">&quot;^&quot;</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="s2">&quot;v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="s2">&quot;p&quot;</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="s2">&quot;h&quot;</span><span class="p">,</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="s2">&quot;H&quot;</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="p">]</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Generating the plot of the mesh&quot;</span><span class="p">)</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="c1"># Plot the mesh</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="c1"># label flag ( to add the label only once)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">label_set</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="c1"># plot every cell as a quadrilateral</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="c1"># loop over all the cells</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">):</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="c1"># get the coordinates of the cell</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cell_coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cell_coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="c1"># add the first point to the end of the array</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="c1"># plot the quadrature points</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="n">x_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="n">y_quad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="n">total_quad</span> <span class="o">+=</span> <span class="n">x_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">label_set</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="n">x_quad</span><span class="p">,</span> <span class="n">y_quad</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Quad Pts&quot;</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="n">label_set</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_quad</span><span class="p">,</span> <span class="n">y_quad</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span> <span class="o">=</span> <span class="n">total_quad</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">bound_dof</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="c1"># plot the boundary points</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="c1"># loop over all the boundary tags</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">bound_id</span><span class="p">,</span> <span class="n">bound_pts</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary_points</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="c1"># get the coordinates of the boundary points</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">bound_pts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">bound_pts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="c1"># add the first point to the end of the array</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">bound_dof</span> <span class="o">+=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bd-id : </span><span class="si">{</span><span class="n">bound_id</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_boundary_dofs</span> <span class="o">=</span> <span class="n">bound_dof</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">))</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;mesh.png&quot;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;mesh.svg&quot;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="c1"># print the total number of quadrature points</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plots generated&quot;</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of cells = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of quadrature points = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Total number of boundary points = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_boundary_dofs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_forcing_function_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_forcing_function_values</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the forcing function values at the quadrature points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The forcing function values at the quadrature points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This function computes the forcing function values at the quadrature points for a given cell.
It loops over all the basis functions and computes the integral using the actual coordinates
and the basis functions at the quadrature points. The resulting values are stored in the
<code>forcing_at_quad</code> attribute of the corresponding <code>fe_cell</code> object.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="k">def</span> <span class="nf">get_forcing_function_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">    Get the forcing function values at the quadrature points.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        np.ndarray: The forcing function values at the quadrature points.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        This function computes the forcing function values at the quadrature points for a given cell.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        It loops over all the basis functions and computes the integral using the actual coordinates</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">        and the basis functions at the quadrature points. The resulting values are stored in the</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">        `forcing_at_quad` attribute of the corresponding `fe_cell` object.</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="p">)</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="c1"># Changed by Thivin: To assemble the forcing function at the quadrature points here in the fespace</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="c1"># so that it can be used to handle multiple dimensions on a vector valud problem</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="c1"># get number of shape functions</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="n">n_shape_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_function</span><span class="o">.</span><span class="n">num_shape_functions</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="c1"># Loop over all the basis functions and compute the integral</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="n">f_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_shape_functions</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_shape_functions</span><span class="p">):</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="c1"># print(&quot;f_values[q] = &quot;,f_values[q])</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="c1"># the Jacobian and the quadrature weights are pre multiplied to the basis functions</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="n">val</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                <span class="n">cell_index</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>            <span class="p">]</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="c1"># print(&quot;val = &quot;, val)</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>        <span class="n">f_integral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="n">f_integral</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_forcing_function_values_vector" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_forcing_function_values_vector</span><span class="p">(</span><span class="n">cell_index</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function will return the forcing function values at the quadrature points
based on the Component of the RHS Needed, for vector valued problems</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>component</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The component of the forcing function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The forcing function values at the quadrature points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="k">def</span> <span class="nf">get_forcing_function_values_vector</span><span class="p">(</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">component</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">    This function will return the forcing function values at the quadrature points</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">    based on the Component of the RHS Needed, for vector valued problems</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">        component (int): The component of the forcing function.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">        np.ndarray: The forcing function values at the quadrature points.</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="c1"># get the coordinates</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="c1"># compute the forcing function values</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="n">f_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="n">component</span><span class="p">]</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="c1"># compute the integral</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="n">f_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span> <span class="o">*</span> <span class="n">f_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span> <span class="o">=</span> <span class="n">f_integral</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_quadrature_actual_coordinates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the actual coordinates of the quadrature points for a given cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: An array containing the actual coordinates of the quadrature points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="k">def</span> <span class="nf">get_quadrature_actual_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    Get the actual coordinates of the quadrature points for a given cell.</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        np.ndarray: An array containing the actual coordinates of the quadrature points.</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="p">)</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_quadrature_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_quadrature_weights</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the quadrature weights for a given cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell for which the quadrature weights are needed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The quadrature weights for the given cell  of dimension (N_Quad_Points, 1).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="k">def</span> <span class="nf">get_quadrature_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    Return the quadrature weights for a given cell.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        cell_index (int): The index of the cell for which the quadrature weights are needed.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        np.ndarray: The quadrature weights for the given cell  of dimension (N_Quad_Points, 1).</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        ValueError: If cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="p">)</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">mult</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_sensor_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sensor_data</span><span class="p">(</span><span class="n">exact_solution</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Obtain sensor data (actual solution) at random points.</p>
<p>This method is used in the inverse problem to obtain the sensor data at random points within the domain.
Currently, it only works for problems with an analytical solution.
Methodologies to obtain sensor data for problems from a file are not implemented yet.
It is also not implemented for external or complex meshes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exact_solution</code>
            </td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact solution function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of points to sample.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing two arrays: sensor points and the exact solution values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="k">def</span> <span class="nf">get_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exact_solution</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">    Obtain sensor data (actual solution) at random points.</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">    This method is used in the inverse problem to obtain the sensor data at random points within the domain.</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="sd">    Currently, it only works for problems with an analytical solution.</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">    Methodologies to obtain sensor data for problems from a file are not implemented yet.</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a><span class="sd">    It is also not implemented for external or complex meshes.</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">        exact_solution (function): The exact solution function.</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        num_points (int): The number of points to sample.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="sd">        Tuple: A tuple containing two arrays: sensor points and the exact solution values.</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="c1"># generate random points within the bounds of the domain</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="c1"># get the bounds of the domain</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>    <span class="n">y_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="n">y_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="c1"># sample n random points within the bounds of the domain</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="c1"># Generate points in the unit square</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="n">num_internal_points</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_points</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="n">num_internal_points</span><span class="p">)</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">x_max</span> <span class="o">-</span> <span class="n">x_min</span><span class="p">)</span> <span class="o">*</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_max</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">*</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>    <span class="c1"># get the exact solution at the points</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="n">exact_sol</span> <span class="o">=</span> <span class="n">exact_solution</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="c1"># print the shape of the points and the exact solution</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Number of sensor points = </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Shape of sensor points = </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="c1"># plot the points</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sensor Points&quot;</span><span class="p">)</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;sensor_points.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">exact_sol</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_sensor_data_external" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_sensor_data_external</span><span class="p">(</span><span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This method is used to obtain the sensor data from an external file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exact_sol</code>
            </td>
            <td>
                  <code>function</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact solution function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of points to sample.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the file containing the sensor data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Tuple</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing two arrays: sensor points and the exact solution values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method reads the sensor data from a file and samples <code>num_points</code> from the data.
The sensor data is then returned as a tuple containing the sensor points and the exact solution values.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="k">def</span> <span class="nf">get_sensor_data_external</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exact_sol</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">    This method is used to obtain the sensor data from an external file.</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">        exact_sol (function): The exact solution function.</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">        num_points (int): The number of points to sample.</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">        file_name (str): The name of the file containing the sensor data.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">        Tuple: A tuple containing two arrays: sensor points and the exact solution values.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">        This method reads the sensor data from a file and samples `num_points` from the data.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">        The sensor data is then returned as a tuple containing the sensor points and the exact solution values.</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>    <span class="c1"># use pandas to read the file</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>    <span class="n">exact_sol</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="c1"># now sample num_points from the data</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">num_points</span><span class="p">)</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>    <span class="n">exact_sol</span> <span class="o">=</span> <span class="n">exact_sol</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="c1"># stack them together</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">exact_sol</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_x" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_x</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to the x-coordinate.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The actual values of the shape functions on the given cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Get the gradient of the shape function with respect to the x-coordinate.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_x_ref" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_x_ref</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to the x-coordinate on the reference element.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The actual values of the shape functions on the given cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_x_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    Get the gradient of the shape function with respect to the x-coordinate on the reference element.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_gradx_at_quad_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_y" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_y</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to y at the given cell index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The actual values of the shape functions on the given cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    Get the gradient of the shape function with respect to y at the given cell index.</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_grady_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_grad_y_ref" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_grad_y_ref</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the gradient of the shape function with respect to y at the reference element.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The actual values of the shape functions on the given cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This function returns the gradient of the shape function with respect to y at the reference element
for a given cell. The shape function gradient values are stored in the <code>basis_grady_at_quad_ref</code> array
of the corresponding finite element cell. The <code>cell_index</code> parameter specifies the index of the cell
for which the shape function gradient is required. If the <code>cell_index</code> is greater than the total number
of cells, a <code>ValueError</code> is raised. The returned gradient values are copied from the <code>basis_grady_at_quad_ref</code> array to ensure immutability.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="k">def</span> <span class="nf">get_shape_function_grad_y_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    Get the gradient of the shape function with respect to y at the reference element.</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        This function returns the gradient of the shape function with respect to y at the reference element</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        for a given cell. The shape function gradient values are stored in the `basis_grady_at_quad_ref` array</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        of the corresponding finite element cell. The `cell_index` parameter specifies the index of the cell</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        for which the shape function gradient is required. If the `cell_index` is greater than the total number</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        of cells, a `ValueError` is raised. The returned gradient values are copied from the `basis_grady_at_quad_ref` array to ensure immutability.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="p">)</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_grady_at_quad_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.get_shape_function_val" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_shape_function_val</span><span class="p">(</span><span class="n">cell_index</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the actual values of the shape functions on a given cell.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cell_index</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The index of the cell.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: The actual values of the shape functions on the given cell.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the cell_index is greater than the number of cells.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="k">def</span> <span class="nf">get_shape_function_val</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    Get the actual values of the shape functions on a given cell.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        cell_index (int): The index of the cell.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        np.ndarray: The actual values of the shape functions on the given cell.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">        ValueError: If the cell_index is greater than the number of cells.</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="k">if</span> <span class="n">cell_index</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">)</span> <span class="ow">or</span> <span class="n">cell_index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="sa">f</span><span class="s2">&quot;cell_index should be less than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="si">}</span><span class="s2"> and greater than or equal to 0&quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Fespace2D.set_finite_elements" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_finite_elements</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assigns the finite elements to each cell.</p>
<p>This method initializes the finite element objects for each cell in the mesh.
It creates an instance of the <code>FE2D_Cell</code> class for each cell, passing the necessary parameters.
The finite element objects store information about the basis functions, gradients, Jacobians,
quadrature points, weights, actual coordinates, and forcing functions associated with each cell.</p>
<p>After initializing the finite element objects, this method prints the shape details of various matrices
and updates the total number of degrees of freedom (dofs) for the entire mesh.</p>
<p>:return: None</p>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\fe\fespace2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="k">def</span> <span class="nf">set_finite_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    Assigns the finite elements to each cell.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    This method initializes the finite element objects for each cell in the mesh.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    It creates an instance of the `FE2D_Cell` class for each cell, passing the necessary parameters.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    The finite element objects store information about the basis functions, gradients, Jacobians,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    quadrature points, weights, actual coordinates, and forcing functions associated with each cell.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    After initializing the finite element objects, this method prints the shape details of various matrices</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    and updates the total number of degrees of freedom (dofs) for the entire mesh.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    :return: None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">total</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Fe2D_cell Setup&quot;</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;cells_assembled&quot;</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">bar_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{l_bar}{bar:40}{r_bar}{bar:-10b}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">colour</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">dof</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_cells</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="n">FE2D_Cell</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cell_type</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fe_order</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fe_type</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quad_order</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quad_type</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fe_transformation_type</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">forcing_function</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="c1"># obtain the shape of the basis function (n_test, N_quad)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">dof</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">progress_bar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="c1"># print the Shape details of all the matrices from cell 0 using print_table function</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">title</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="s2">&quot;Shape function Matrix Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="s2">&quot;Shape function Gradient Matrix Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="s2">&quot;Jacobian Matrix Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="s2">&quot;Quadrature Points Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="s2">&quot;Quadrature Weights Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="s2">&quot;Quadrature Actual Coordinates Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="s2">&quot;Forcing Function Shape&quot;</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="p">]</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basis_gradx_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">jacobian</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quad_xi</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quad_weight</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quad_actual_coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fe_cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">forcing_at_quad</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="p">]</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">print_table</span><span class="p">(</span><span class="s2">&quot;fe Matrix Shapes&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">,</span> <span class="s2">&quot;Shape&quot;</span><span class="p">],</span> <span class="n">title</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="c1"># update the total number of dofs</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_dofs</span> <span class="o">=</span> <span class="n">dof</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry" class="doc doc-heading">
            <code>Geometry</code>


</h2>


    <div class="doc doc-contents ">


        <p>Abstract base class for geometry and mesh operations.</p>
<p>This class defines the interface that all geometry implementations must
follow, providing the basic structure for mesh handling operations in
both 2D and 3D contexts.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.mesh_type">mesh_type</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of mesh elements (e.g., 'quadrilateral', 'triangle')</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.mesh_generation_method">mesh_generation_method</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for mesh generation ('internal'/'external')</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>class Geometry2D(Geometry):
...     def <strong>init</strong>(self, mesh_type='quadrilateral',
...                  method='internal'):
...         super().<strong>init</strong>(mesh_type, method)
...
...     def read_mesh(self, mesh_file, boundary_level,
...                   sampling_method, refine_level):
...         # Implementation
...         pass
...
...     def generate_vtk_for_test(self):
...         # Implementation
...         pass
...
...     def get_test_points(self):
...         # Implementation
...         return points</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>This is an abstract base class. Concrete implementations must override:
- read_mesh()
- generate_vtk_for_test()
- get_test_points()</p>
<p>Each implementation should provide appropriate mesh handling for its
specific dimensional and element type requirements.</p>
</details>





              <details class="quote">
                <summary>Source code in <code>scirex\core\sciml\geometry\geometry.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">class</span> <span class="nc">Geometry</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for geometry and mesh operations.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    This class defines the interface that all geometry implementations must</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    follow, providing the basic structure for mesh handling operations in</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    both 2D and 3D contexts.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        mesh_type: Type of mesh elements (e.g., &#39;quadrilateral&#39;, &#39;triangle&#39;)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        mesh_generation_method: Method for mesh generation (&#39;internal&#39;/&#39;external&#39;)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        &gt;&gt;&gt; class Geometry2D(Geometry):</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        ...     def __init__(self, mesh_type=&#39;quadrilateral&#39;,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        ...                  method=&#39;internal&#39;):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        ...         super().__init__(mesh_type, method)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        ...</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        ...     def read_mesh(self, mesh_file, boundary_level,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        ...                   sampling_method, refine_level):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        ...         # Implementation</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        ...         pass</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        ...</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        ...     def generate_vtk_for_test(self):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        ...         # Implementation</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ...         pass</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        ...</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        ...     def get_test_points(self):</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        ...         # Implementation</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        ...         return points</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        This is an abstract base class. Concrete implementations must override:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        - read_mesh()</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        - generate_vtk_for_test()</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        - get_test_points()</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        Each implementation should provide appropriate mesh handling for its</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        specific dimensional and element type requirements.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mesh_generation_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        Constructor for the Geometry class.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            mesh_type: Type of mesh elements (e.g., &#39;quadrilateral&#39;, &#39;triangle&#39;)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            mesh_generation_method: Method for mesh generation (&#39;internal&#39;/&#39;external&#39;)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            None</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="o">=</span> <span class="n">mesh_type</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">=</span> <span class="n">mesh_generation_method</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">def</span> <span class="nf">read_mesh</span><span class="p">(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">mesh_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">boundary_point_refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">bd_sampling_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="p">):</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        Abstract method to read mesh from Gmsh. This method should be implemented by the derived classes.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            mesh_file (str): Path to the mesh file</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            boundary_point_refinement_level (int): Level of refinement for boundary points</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            bd_sampling_method (str): Sampling method for boundary points</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            refinement_level (int): Level of mesh refinement</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            None</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">def</span> <span class="nf">generate_vtk_for_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Generates a VTK from Mesh file (External) or using gmsh (for Internal).</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        None</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        None</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">def</span> <span class="nf">get_test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        This function is used to extract the test points from the given mesh</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            None</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            points (np.ndarray): Test points extracted from the mesh</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh_type</span><span class="p">,</span> <span class="n">mesh_generation_method</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for the Geometry class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mesh_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of mesh elements (e.g., 'quadrilateral', 'triangle')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mesh_generation_method</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for mesh generation ('internal'/'external')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mesh_generation_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    Constructor for the Geometry class.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        mesh_type: Type of mesh elements (e.g., &#39;quadrilateral&#39;, &#39;triangle&#39;)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        mesh_generation_method: Method for mesh generation (&#39;internal&#39;/&#39;external&#39;)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">        None</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="o">=</span> <span class="n">mesh_type</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">=</span> <span class="n">mesh_generation_method</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.generate_vtk_for_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_vtk_for_test</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a VTK from Mesh file (External) or using gmsh (for Internal).</p>
<p>Args:
None</p>
<p>Returns:
None</p>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span> <span class="nf">generate_vtk_for_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    Generates a VTK from Mesh file (External) or using gmsh (for Internal).</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    None</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    None</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.get_test_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_test_points</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>This function is used to extract the test points from the given mesh</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>points</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test points extracted from the mesh</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="k">def</span> <span class="nf">get_test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    This function is used to extract the test points from the given mesh</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        None</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        points (np.ndarray): Test points extracted from the mesh</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry.read_mesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_mesh</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="n">boundary_point_refinement_level</span><span class="p">,</span> <span class="n">bd_sampling_method</span><span class="p">,</span> <span class="n">refinement_level</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Abstract method to read mesh from Gmsh. This method should be implemented by the derived classes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mesh_file</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the mesh file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boundary_point_refinement_level</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Level of refinement for boundary points</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bd_sampling_method</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sampling method for boundary points</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refinement_level</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Level of mesh refinement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="k">def</span> <span class="nf">read_mesh</span><span class="p">(</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">mesh_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">boundary_point_refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">bd_sampling_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="p">):</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Abstract method to read mesh from Gmsh. This method should be implemented by the derived classes.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        mesh_file (str): Path to the mesh file</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        boundary_point_refinement_level (int): Level of refinement for boundary points</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        bd_sampling_method (str): Sampling method for boundary points</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        refinement_level (int): Level of mesh refinement</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        None</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D" class="doc doc-heading">
            <code>Geometry_2D</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="scirex.core.sciml.geometry.geometry.Geometry" href="../../../geometry/geometry/#scirex.core.sciml.geometry.geometry.Geometry">Geometry</a></code></p>


        <p>Implements 2D geometry and mesh handling capabilities.</p>
<p>This class provides comprehensive functionality for managing 2D meshes,
including both internal generation and external mesh reading. It supports
various mesh operations, boundary handling, and visualization capabilities.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.mesh_type">mesh_type</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of mesh elements ('quadrilateral')</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.mesh_generation_method">mesh_generation_method</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method of mesh generation ('internal'/'external')</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.n_test_points_x">n_test_points_x</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of test points in x-direction</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.n_test_points_y">n_test_points_y</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of test points in y-direction</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.output_folder">output_folder</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path for output files</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.is_optimized">is_optimized</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for mesh optimization</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.n_cells_x">n_cells_x</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cells in x-direction (internal mesh)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.n_cells_y">n_cells_y</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cells in y-direction (internal mesh)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.x_limits">x_limits</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain limits in x-direction</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.y_limits">y_limits</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain limits in y-direction</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.mesh_file_name">mesh_file_name</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of external mesh file</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.mesh">mesh</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MeshIO mesh object</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.bd_dict">bd_dict</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of boundary points</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.cell_points">cell_points</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of cell vertices</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.test_points">test_points</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of test points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>geometry = Geometry_2D(
...     mesh_type='quadrilateral',
...     mesh_generation_method='internal',
...     n_test_points_x=10,
...     n_test_points_y=10,
...     output_folder='./output'
... )
cells, bounds = geometry.generate_quad_mesh_internal(
...     x_limits=(0,1),
...     y_limits=(0,1),
...     n_cells_x=5,
...     n_cells_y=5,
...     num_boundary_points=40
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Only supports quadrilateral elements</li>
<li>Internal mesh generation is limited to rectangular domains</li>
<li>External mesh reading requires Gmsh format</li>
<li>Boundary points can be sampled uniformly or using LHS</li>
</ul>
</details>





              <details class="quote">
                <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">class</span> <span class="nc">Geometry_2D</span><span class="p">(</span><span class="n">Geometry</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Implements 2D geometry and mesh handling capabilities.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    This class provides comprehensive functionality for managing 2D meshes,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    including both internal generation and external mesh reading. It supports</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    various mesh operations, boundary handling, and visualization capabilities.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        mesh_type: Type of mesh elements (&#39;quadrilateral&#39;)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        mesh_generation_method: Method of mesh generation (&#39;internal&#39;/&#39;external&#39;)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        n_test_points_x: Number of test points in x-direction</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        n_test_points_y: Number of test points in y-direction</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        output_folder: Path for output files</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        is_optimized: Flag for mesh optimization</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        n_cells_x: Number of cells in x-direction (internal mesh)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        n_cells_y: Number of cells in y-direction (internal mesh)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        x_limits: Domain limits in x-direction</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        y_limits: Domain limits in y-direction</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        mesh_file_name: Name of external mesh file</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        mesh: MeshIO mesh object</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        bd_dict: Dictionary of boundary points</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        cell_points: Array of cell vertices</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        test_points: Array of test points</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &gt;&gt;&gt; geometry = Geometry_2D(</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        ...     mesh_type=&#39;quadrilateral&#39;,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        ...     mesh_generation_method=&#39;internal&#39;,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        ...     n_test_points_x=10,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        ...     n_test_points_y=10,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        ...     output_folder=&#39;./output&#39;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        &gt;&gt;&gt; cells, bounds = geometry.generate_quad_mesh_internal(</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        ...     x_limits=(0,1),</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        ...     y_limits=(0,1),</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        ...     n_cells_x=5,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ...     n_cells_y=5,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        ...     num_boundary_points=40</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        - Only supports quadrilateral elements</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        - Internal mesh generation is limited to rectangular domains</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">        - External mesh reading requires Gmsh format</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        - Boundary points can be sampled uniformly or using LHS</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">mesh_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">mesh_generation_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">n_test_points_x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">n_test_points_y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">is_optimized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="p">):</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        Constructor for Geometry_2D class.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            mesh_type: Type of mesh elements (&#39;quadrilateral&#39;)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            mesh_generation_method: Method of mesh generation (&#39;internal&#39;/&#39;external&#39;)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            n_test_points_x: Number of test points in x-direction</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            n_test_points_y: Number of test points in y-direction</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            output_folder: Path for output files</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            is_optimized: Flag for mesh optimization</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            ValueError: If mesh type or generation method is invalid</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            None</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="c1"># Call the super class constructor</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh_type</span><span class="p">,</span> <span class="n">mesh_generation_method</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="o">=</span> <span class="n">mesh_type</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">=</span> <span class="n">mesh_generation_method</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_x</span> <span class="o">=</span> <span class="n">n_test_points_x</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_y</span> <span class="o">=</span> <span class="n">n_test_points_y</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">=</span> <span class="n">output_folder</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_optimized</span> <span class="o">=</span> <span class="n">is_optimized</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;internal&quot;</span><span class="p">,</span> <span class="s2">&quot;external&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid mesh generation method </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="s2">&quot;Mesh generation method should be either internal or external.&quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;quadrilateral&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid mesh type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mesh type should be quadrilateral only.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="c1"># To be filled - only when mesh is internal</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_x</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_y</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># to be filled by external</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_name</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">def</span> <span class="nf">read_mesh</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">mesh_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">boundary_point_refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">bd_sampling_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="p">):</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Reads mesh from a Gmsh .msh file and extracts cell information.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            mesh_file: Path to the mesh file</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            boundary_point_refinement_level: Level of boundary point refinement</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            bd_sampling_method: Method for boundary point sampling (&#39;uniform&#39;/&#39;lhs&#39;)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            refinement_level: Level of mesh refinement</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            cell_points: Array of cell vertices</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            bd_dict: Dictionary of boundary points</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            ValueError: If mesh file format is invalid</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_name</span> <span class="o">=</span> <span class="n">mesh_file</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="c1"># bd_sampling_method = &quot;uniform&quot;  # &quot;uniform&quot; or &quot;lhs&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">file_extension</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">if</span> <span class="n">file_extension</span> <span class="o">!=</span> <span class="s2">&quot;.mesh&quot;</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mesh file should be in .mesh format.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="c1"># Read mesh using meshio</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="o">==</span> <span class="s2">&quot;quadrilateral&quot;</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="c1"># Extract cell information</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells_dict</span><span class="p">[</span><span class="s2">&quot;quad&quot;</span><span class="p">]</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">num_cells</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Number of cells = </span><span class="si">{</span><span class="n">num_cells</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">cell_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">cells</span><span class="p">][</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="p">]</span>  <span class="c1"># remove the z coordinate, which is 0 for all points</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="c1"># loop over all cells and rearrange the points in anticlockwise direction</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cells</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">cell</span> <span class="o">=</span> <span class="n">cell_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="c1"># get the centroid of the cell</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="c1"># get the angle of each point with respect to the centroid</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">cell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="c1"># sort the points based on the angles</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">cell_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">angles</span><span class="p">)]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># Extract number of points within each cell</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Number of points per cell = </span><span class="si">{</span><span class="n">cell_points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="c1"># Collect the Boundary point id&#39;s within the domain</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">boundary_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells_dict</span><span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">]</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="c1"># Using the point id, collect the coordinates of the boundary points</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">boundary_coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">boundary_edges</span><span class="p">]</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="c1"># Number of Existing Boundary points</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="sa">f</span><span class="s2">&quot;[INFO] : Number of Bound points before refinement = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">boundary_coordinates</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1"># now Get the physical tag of the boundary edges</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">boundary_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s2">&quot;medit:ref&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="c1"># Generate a Dictionary of boundary tags and boundary coordinates</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># Keys will be the boundary tags and values will be the list of coordinates</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">boundary_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="c1"># refine the boundary points based on the number of boundary points needed</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boundary_coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">p1</span> <span class="o">=</span> <span class="n">boundary_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">p2</span> <span class="o">=</span> <span class="n">boundary_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="k">if</span> <span class="n">bd_sampling_method</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="c1"># take the current point and next point and then perform a uniform sampling</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                <span class="n">new_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                    <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">boundary_point_refinement_level</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                <span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="k">elif</span> <span class="n">bd_sampling_method</span> <span class="o">==</span> <span class="s2">&quot;lhs&quot;</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                <span class="c1"># take the current point and next point and then perform a uniform sampling</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                <span class="n">new_points</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">boundary_point_refinement_level</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                    <span class="sa">f</span><span class="s2">&quot;Invalid sampling method </span><span class="si">{</span><span class="n">bd_sampling_method</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                <span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling method should be either uniform or lhs.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="c1"># get the boundary tag</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="n">tag</span> <span class="o">=</span> <span class="n">boundary_tags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">boundary_dict</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>                <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_points</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                <span class="n">current_val</span> <span class="o">=</span> <span class="n">new_points</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                <span class="n">prev_val</span> <span class="o">=</span> <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                <span class="n">final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">prev_val</span><span class="p">,</span> <span class="n">current_val</span><span class="p">])</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">final</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="c1"># get unique</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">boundary_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="n">val</span> <span class="o">=</span> <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>            <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span> <span class="o">=</span> <span class="n">boundary_dict</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="c1"># print the new boundary points  on each boundary tag (key) in a tabular format</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">total_bound_points</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="s1">&#39;Boundary ID&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Number of Points&#39;</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">12</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">---</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">16</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="n">total_bound_points</span> <span class="o">+=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : No of bound pts after refinement:  </span><span class="si">{</span><span class="n">total_bound_points</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="c1"># Assign to class values</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span> <span class="o">=</span> <span class="n">cell_points</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="c1"># generate testvtk</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_vtk_for_test</span><span class="p">()</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="k">return</span> <span class="n">cell_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">def</span> <span class="nf">generate_quad_mesh_internal</span><span class="p">(</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">x_limits</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">y_limits</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">n_cells_x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">n_cells_y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">num_boundary_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        Generate and save a quadrilateral mesh with physical curves.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            x_limits: Domain limits in x-direction</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            y_limits: Domain limits in y-direction</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            n_cells_x: Number of cells in x-direction</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            n_cells_y: Number of cells in y-direction</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            num_boundary_points: Number of boundary points</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            cell_points: Array of cell vertices</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            bd_dict: Dictionary of boundary points</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_x</span> <span class="o">=</span> <span class="n">n_cells_x</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_y</span> <span class="o">=</span> <span class="n">n_cells_y</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">=</span> <span class="n">x_limits</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span> <span class="o">=</span> <span class="n">y_limits</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>        <span class="c1"># generate linspace of points in x and y direction</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_cells_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_cells_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="c1"># Generate quad cells from the points</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="c1"># the output should be a list of 4 points for each cell , each being a list of 2 points [x,y]</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells_x</span><span class="p">):</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells_y</span><span class="p">):</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>                <span class="c1"># get the four points of the cell</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>                <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="n">p3</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                <span class="n">p4</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                <span class="c1"># append the points to the cells</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">])</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="c1"># convert to numpy array</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="c1"># use arctan2 to sort the points in anticlockwise direction</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="c1"># loop over all cells and rearrange the points in anticlockwise direction</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="n">cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="c1"># get the centroid of the cell</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="c1"># get the angle of each point with respect to the centroid</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">cell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="c1"># sort the points based on the angles</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">angles</span><span class="p">)]</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="c1"># generate a meshio mesh object using the cells</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="n">points</span><span class="o">=</span><span class="n">cells</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">cells</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;quad&quot;</span><span class="p">,</span> <span class="n">cells</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))]</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="c1"># lets generate the boundary points, this function will return a dictionary of boundary points</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="c1"># the keys will be the boundary tags and values will be the list of boundary points</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">bd_points</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="n">num_bound_per_side</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_boundary_points</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">def</span> <span class="nf">_temp_bd_func</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">num_pts</span><span class="p">):</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            This function returns the boundary points between the start and end points</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            using lhs sampling.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            Args:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">                start: Start point of the boundary</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">                end: End point of the boundary</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">                num_pts: Number of boundary points to be generated</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            Returns:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">                bd_pts: Array of boundary points</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="c1"># generate the boundary points using lhs as a np.float64 array</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="n">bd_pts</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pts</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="c1"># scale the points</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="n">bd_pts</span> <span class="o">=</span> <span class="n">bd_pts</span> <span class="o">*</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="n">start</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="k">return</span> <span class="n">bd_pts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="c1"># bottom boundary</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="n">y_bottom</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">x_bottom</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="n">bd_points</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_bottom</span><span class="p">,</span> <span class="n">y_bottom</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="c1"># right boundary</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">x_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">y_right</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">bd_points</span><span class="p">[</span><span class="mi">1001</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_right</span><span class="p">,</span> <span class="n">y_right</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="c1"># top boundary</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">y_top</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="n">x_top</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="n">bd_points</span><span class="p">[</span><span class="mi">1002</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_top</span><span class="p">,</span> <span class="n">y_top</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="c1"># left boundary</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="n">x_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="n">y_left</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="n">bd_points</span><span class="p">[</span><span class="mi">1003</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_left</span><span class="p">,</span> <span class="n">y_left</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span> <span class="o">=</span> <span class="n">cells</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span> <span class="o">=</span> <span class="n">bd_points</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="c1"># generate vtk</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_optimized</span><span class="p">:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generate_vtk_for_test</span><span class="p">()</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="k">def</span> <span class="nf">generate_vtk_for_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        Generates a VTK from Mesh file (External) or using gmsh (for Internal).</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            None</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            None</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="c1"># initialise the mesh</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="c1"># Now, lets generate the mesh with the points.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="n">x_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">y_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="n">mesh_size_x</span> <span class="o">=</span> <span class="n">x_range</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_x</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="n">mesh_size_y</span> <span class="o">=</span> <span class="n">y_range</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_y</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="c1"># generate a gmsh with the given parameters</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="n">Xmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="n">Xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="n">Ymin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="n">Ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="n">point1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmin</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_x</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">point2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmax</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_x</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="n">point3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmax</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_y</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">point4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmin</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_y</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="n">line1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1">## Bottom</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">line2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>  <span class="c1">## Right</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="n">line3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point3</span><span class="p">,</span> <span class="n">point4</span><span class="p">,</span> <span class="mi">1002</span><span class="p">)</span>  <span class="c1">## Top</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">line4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point4</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="mi">1003</span><span class="p">)</span>  <span class="c1">## Left</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">face1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_curve_loop</span><span class="p">([</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">line3</span><span class="p">,</span> <span class="n">line4</span><span class="p">])</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_plane_surface</span><span class="p">([</span><span class="n">face1</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="c1"># Create the relevant Gmsh data structures</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="c1"># from Gmsh model.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="c1"># Generate mesh:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="n">mesh_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;internal.msh&quot;</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;internal.vtk&quot;</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] : Internal mesh file generated at &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="c1"># close the gmsh</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="c1"># read the mesh using meshio</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">gmsh</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="n">meshio</span><span class="o">.</span><span class="n">vtk</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">),</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt_version</span><span class="o">=</span><span class="s2">&quot;4.2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>                <span class="s2">&quot;[INFO] : VTK file for internal mesh file generated at &quot;</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">),</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;external.vtk&quot;</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="c1"># Use the internal mesh to generate the vtk file</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="n">meshio</span><span class="o">.</span><span class="n">vtk</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">),</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt_version</span><span class="o">=</span><span class="s2">&quot;4.2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                <span class="s2">&quot;[INFO] : VTK file for external mesh file generated at &quot;</span><span class="p">,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                <span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">),</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="k">def</span> <span class="nf">get_test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        This function is used to extract the test points from the given mesh</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">            None</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">            test_points (np.ndarray): Array of test points</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="c1"># vtk_file_name  = Path(self.output_folder) / &quot;internal.vtk&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="c1"># code over written to plot from np.linspace instead of vtk file</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="c1"># generate linspace of points in x and y direction based on x and y limits</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_x</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_y</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="c1"># generate meshgrid</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="c1"># stack the points</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_grid</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">y_grid</span><span class="o">.</span><span class="n">flatten</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;external.vtk&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">))</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="n">points</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">points</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="k">return</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># return only first two columns</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="k">def</span> <span class="nf">write_vtk</span><span class="p">(</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_names</span><span class="p">:</span> <span class="nb">list</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="p">):</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        Writes the data to a VTK file.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">            solution: The solution data to be written</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">            output_path: The output path for the VTK file</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">            filename: The name of the output file</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">            data_names: List of data names</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">            None</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="c1"># read the existing vtk into file</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>            <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;internal.vtk&quot;</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;external.vtk&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">File</span><span class="p">:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">File</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="c1"># get the output file name</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">output_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="k">if</span> <span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_names</span><span class="p">):</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Error] : File : geometry_2d.py, Function: write_vtk&quot;</span><span class="p">)</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>                <span class="s2">&quot;Num Columns in solution = &quot;</span><span class="p">,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>                <span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>                <span class="s2">&quot; Num of data names = &quot;</span><span class="p">,</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>                <span class="nb">len</span><span class="p">(</span><span class="n">data_names</span><span class="p">),</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>            <span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of data names and solution columns are not equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="c1"># write the data to the output file</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FN</span><span class="p">:</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>                <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>                <span class="k">if</span> <span class="s2">&quot;POINT_DATA&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                    <span class="k">break</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;SCALARS &quot;</span> <span class="o">+</span> <span class="n">data_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; float</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;LOOKUP_TABLE default</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">FN</span><span class="p">,</span> <span class="n">solution</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="c1"># save the vtk file as image</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="c1"># self.save_vtk_as_image(str(output_file_name), data_names)</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">def</span> <span class="nf">plot_adaptive_mesh</span><span class="p">(</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">cells_list</span><span class="p">,</span> <span class="n">area_averaged_cell_loss_list</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;cell_residual&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="p">):</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">        Plots the residuals in each cell of the mesh.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">            cells_list: List of cell vertices</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">            area_averaged_cell_loss_list: List of area averaged cell loss</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">            epoch: The epoch number</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">            filename: The output filename</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">            None</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="c1"># normalise colors</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>            <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">area_averaged_cell_loss_list</span><span class="p">),</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>            <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">area_averaged_cell_loss_list</span><span class="p">),</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>        <span class="p">)</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="c1"># Create a colormap</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>        <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells_list</span><span class="p">):</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>            <span class="n">curr_cell_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">area_averaged_cell_loss_list</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="n">color</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">curr_cell_loss</span><span class="p">))</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="c1"># # compute x_min, x_max, y_min, y_max</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="c1"># x_min = np.min(x)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>            <span class="c1"># x_max = np.max(x)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="c1"># y_min = np.min(y)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="c1"># y_max = np.max(y)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>            <span class="c1"># # compute centroid of the cells</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>            <span class="c1"># centroid = np.array([np.mean(x), np.mean(y)])</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>            <span class="c1"># plot the loss text within the cell</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>            <span class="c1"># plt.text(centroid[0], centroid[1], f&quot;{curr_cell_loss:.3e}&quot;, fontsize=16, horizontalalignment=&#39;center&#39;, verticalalignment=&#39;center&#39;)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="c1"># output filename</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">output_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cell Residual&quot;</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_filename</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh_type</span><span class="p">,</span> <span class="n">mesh_generation_method</span><span class="p">,</span> <span class="n">n_test_points_x</span><span class="p">,</span> <span class="n">n_test_points_y</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">is_optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor for Geometry_2D class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mesh_type</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of mesh elements ('quadrilateral')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mesh_generation_method</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method of mesh generation ('internal'/'external')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_test_points_x</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of test points in x-direction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_test_points_y</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of test points in y-direction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path for output files</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_optimized</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag for mesh optimization</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If mesh type or generation method is invalid</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">mesh_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">mesh_generation_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">n_test_points_x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">n_test_points_y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">output_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">is_optimized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="p">):</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Constructor for Geometry_2D class.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        mesh_type: Type of mesh elements (&#39;quadrilateral&#39;)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        mesh_generation_method: Method of mesh generation (&#39;internal&#39;/&#39;external&#39;)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        n_test_points_x: Number of test points in x-direction</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        n_test_points_y: Number of test points in y-direction</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        output_folder: Path for output files</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        is_optimized: Flag for mesh optimization</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        ValueError: If mesh type or generation method is invalid</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        None</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="c1"># Call the super class constructor</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">mesh_type</span><span class="p">,</span> <span class="n">mesh_generation_method</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="o">=</span> <span class="n">mesh_type</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">=</span> <span class="n">mesh_generation_method</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_x</span> <span class="o">=</span> <span class="n">n_test_points_x</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_y</span> <span class="o">=</span> <span class="n">n_test_points_y</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span> <span class="o">=</span> <span class="n">output_folder</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_optimized</span> <span class="o">=</span> <span class="n">is_optimized</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;internal&quot;</span><span class="p">,</span> <span class="s2">&quot;external&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid mesh generation method </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="s2">&quot;Mesh generation method should be either internal or external.&quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;quadrilateral&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="sa">f</span><span class="s2">&quot;Invalid mesh type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mesh type should be quadrilateral only.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="c1"># To be filled - only when mesh is internal</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_x</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_y</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="c1"># to be filled by external</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_name</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.generate_quad_mesh_internal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_quad_mesh_internal</span><span class="p">(</span><span class="n">x_limits</span><span class="p">,</span> <span class="n">y_limits</span><span class="p">,</span> <span class="n">n_cells_x</span><span class="p">,</span> <span class="n">n_cells_y</span><span class="p">,</span> <span class="n">num_boundary_points</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate and save a quadrilateral mesh with physical curves.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x_limits</code>
            </td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain limits in x-direction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_limits</code>
            </td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Domain limits in y-direction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_cells_x</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cells in x-direction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_cells_y</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of cells in y-direction</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_boundary_points</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of boundary points</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cell_points</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of cell vertices</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>bd_dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of boundary points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="k">def</span> <span class="nf">generate_quad_mesh_internal</span><span class="p">(</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="n">x_limits</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="n">y_limits</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="n">n_cells_x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">n_cells_y</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">num_boundary_points</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Generate and save a quadrilateral mesh with physical curves.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        x_limits: Domain limits in x-direction</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        y_limits: Domain limits in y-direction</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        n_cells_x: Number of cells in x-direction</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        n_cells_y: Number of cells in y-direction</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        num_boundary_points: Number of boundary points</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        cell_points: Array of cell vertices</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        bd_dict: Dictionary of boundary points</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_x</span> <span class="o">=</span> <span class="n">n_cells_x</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_cells_y</span> <span class="o">=</span> <span class="n">n_cells_y</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span> <span class="o">=</span> <span class="n">x_limits</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span> <span class="o">=</span> <span class="n">y_limits</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="c1"># generate linspace of points in x and y direction</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_cells_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_cells_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="c1"># Generate quad cells from the points</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="c1"># the output should be a list of 4 points for each cell , each being a list of 2 points [x,y]</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells_x</span><span class="p">):</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_cells_y</span><span class="p">):</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="c1"># get the four points of the cell</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="n">p3</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="n">p4</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="c1"># append the points to the cells</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">])</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="c1"># convert to numpy array</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="c1"># use arctan2 to sort the points in anticlockwise direction</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="c1"># loop over all cells and rearrange the points in anticlockwise direction</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">cell</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="c1"># get the centroid of the cell</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>        <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="c1"># get the angle of each point with respect to the centroid</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">cell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="c1"># sort the points based on the angles</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">angles</span><span class="p">)]</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># generate a meshio mesh object using the cells</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">points</span><span class="o">=</span><span class="n">cells</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">cells</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;quad&quot;</span><span class="p">,</span> <span class="n">cells</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">))]</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="c1"># lets generate the boundary points, this function will return a dictionary of boundary points</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="c1"># the keys will be the boundary tags and values will be the list of boundary points</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="n">bd_points</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">num_bound_per_side</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_boundary_points</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">def</span> <span class="nf">_temp_bd_func</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">num_pts</span><span class="p">):</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        This function returns the boundary points between the start and end points</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        using lhs sampling.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            start: Start point of the boundary</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">            end: End point of the boundary</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            num_pts: Number of boundary points to be generated</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            bd_pts: Array of boundary points</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="c1"># generate the boundary points using lhs as a np.float64 array</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">bd_pts</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pts</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="c1"># scale the points</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="n">bd_pts</span> <span class="o">=</span> <span class="n">bd_pts</span> <span class="o">*</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="n">start</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="k">return</span> <span class="n">bd_pts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="c1"># bottom boundary</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="n">y_bottom</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="n">x_bottom</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="n">bd_points</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_bottom</span><span class="p">,</span> <span class="n">y_bottom</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="c1"># right boundary</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">x_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="n">y_right</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">bd_points</span><span class="p">[</span><span class="mi">1001</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_right</span><span class="p">,</span> <span class="n">y_right</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="c1"># top boundary</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="n">y_top</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">x_top</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="n">bd_points</span><span class="p">[</span><span class="mi">1002</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_top</span><span class="p">,</span> <span class="n">y_top</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="c1"># left boundary</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">x_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_bound_per_side</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">y_left</span> <span class="o">=</span> <span class="n">_temp_bd_func</span><span class="p">(</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num_bound_per_side</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">bd_points</span><span class="p">[</span><span class="mi">1003</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_left</span><span class="p">,</span> <span class="n">y_left</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span> <span class="o">=</span> <span class="n">cells</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span> <span class="o">=</span> <span class="n">bd_points</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># generate vtk</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_optimized</span><span class="p">:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_vtk_for_test</span><span class="p">()</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.generate_vtk_for_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_vtk_for_test</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a VTK from Mesh file (External) or using gmsh (for Internal).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="k">def</span> <span class="nf">generate_vtk_for_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">    Generates a VTK from Mesh file (External) or using gmsh (for Internal).</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        None</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        None</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="c1"># initialise the mesh</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="c1"># Now, lets generate the mesh with the points.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">x_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="n">y_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="n">mesh_size_x</span> <span class="o">=</span> <span class="n">x_range</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_x</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">mesh_size_y</span> <span class="o">=</span> <span class="n">y_range</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_y</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="c1"># generate a gmsh with the given parameters</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="n">Xmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">Xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">Ymin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">Ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">point1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmin</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_x</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">point2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmax</span><span class="p">,</span> <span class="n">Ymin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_x</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">point3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmax</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_y</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">point4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">Xmin</span><span class="p">,</span> <span class="n">Ymax</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mesh_size_y</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">line1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1">## Bottom</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">line2</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>  <span class="c1">## Right</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">line3</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point3</span><span class="p">,</span> <span class="n">point4</span><span class="p">,</span> <span class="mi">1002</span><span class="p">)</span>  <span class="c1">## Top</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">line4</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">point4</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="mi">1003</span><span class="p">)</span>  <span class="c1">## Left</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">face1</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_curve_loop</span><span class="p">([</span><span class="n">line1</span><span class="p">,</span> <span class="n">line2</span><span class="p">,</span> <span class="n">line3</span><span class="p">,</span> <span class="n">line4</span><span class="p">])</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">add_plane_surface</span><span class="p">([</span><span class="n">face1</span><span class="p">])</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="c1"># Create the relevant Gmsh data structures</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="c1"># from Gmsh model.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">geo</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="c1"># Generate mesh:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">mesh_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;internal.msh&quot;</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;internal.vtk&quot;</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[INFO] : Internal mesh file generated at &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="c1"># close the gmsh</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">gmsh</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="c1"># read the mesh using meshio</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">gmsh</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="n">meshio</span><span class="o">.</span><span class="n">vtk</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">),</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt_version</span><span class="o">=</span><span class="s2">&quot;4.2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="s2">&quot;[INFO] : VTK file for internal mesh file generated at &quot;</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">mesh_file_name</span><span class="p">),</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;external.vtk&quot;</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="c1"># Use the internal mesh to generate the vtk file</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_name</span><span class="p">))</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="n">meshio</span><span class="o">.</span><span class="n">vtk</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">),</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt_version</span><span class="o">=</span><span class="s2">&quot;4.2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="s2">&quot;[INFO] : VTK file for external mesh file generated at &quot;</span><span class="p">,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">),</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.get_test_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_test_points</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This function is used to extract the test points from the given mesh</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>test_points</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of test points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="k">def</span> <span class="nf">get_test_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    This function is used to extract the test points from the given mesh</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        None</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        test_points (np.ndarray): Array of test points</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="c1"># vtk_file_name  = Path(self.output_folder) / &quot;internal.vtk&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="c1"># code over written to plot from np.linspace instead of vtk file</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="c1"># generate linspace of points in x and y direction based on x and y limits</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_x</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_test_points_y</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="c1"># generate meshgrid</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="c1"># stack the points</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x_grid</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">y_grid</span><span class="o">.</span><span class="n">flatten</span><span class="p">()])</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_points</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;external.vtk&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">))</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="n">points</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">points</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># return only first two columns</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.plot_adaptive_mesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_adaptive_mesh</span><span class="p">(</span><span class="n">cells_list</span><span class="p">,</span> <span class="n">area_averaged_cell_loss_list</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;cell_residual&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plots the residuals in each cell of the mesh.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cells_list</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of cell vertices</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>area_averaged_cell_loss_list</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of area averaged cell loss</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epoch</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The epoch number</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output filename</p>
              </div>
            </td>
            <td>
                  <code>&#39;cell_residual&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="k">def</span> <span class="nf">plot_adaptive_mesh</span><span class="p">(</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">cells_list</span><span class="p">,</span> <span class="n">area_averaged_cell_loss_list</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;cell_residual&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="p">):</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    Plots the residuals in each cell of the mesh.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        cells_list: List of cell vertices</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        area_averaged_cell_loss_list: List of area averaged cell loss</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        epoch: The epoch number</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">        filename: The output filename</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        None</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>    <span class="c1"># normalise colors</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="n">norm</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">area_averaged_cell_loss_list</span><span class="p">),</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">area_averaged_cell_loss_list</span><span class="p">),</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="p">)</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="c1"># Create a colormap</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cells_list</span><span class="p">):</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">curr_cell_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">area_averaged_cell_loss_list</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">color</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">curr_cell_loss</span><span class="p">))</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="c1"># # compute x_min, x_max, y_min, y_max</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="c1"># x_min = np.min(x)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="c1"># x_max = np.max(x)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="c1"># y_min = np.min(y)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="c1"># y_max = np.max(y)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="c1"># # compute centroid of the cells</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="c1"># centroid = np.array([np.mean(x), np.mean(y)])</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="c1"># plot the loss text within the cell</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="c1"># plt.text(centroid[0], centroid[1], f&quot;{curr_cell_loss:.3e}&quot;, fontsize=16, horizontalalignment=&#39;center&#39;, verticalalignment=&#39;center&#39;)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="c1"># output filename</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="n">output_filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cell Residual&quot;</span><span class="p">)</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_filename</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.read_mesh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_mesh</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">,</span> <span class="n">boundary_point_refinement_level</span><span class="p">,</span> <span class="n">bd_sampling_method</span><span class="p">,</span> <span class="n">refinement_level</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reads mesh from a Gmsh .msh file and extracts cell information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mesh_file</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the mesh file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boundary_point_refinement_level</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Level of boundary point refinement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bd_sampling_method</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for boundary point sampling ('uniform'/'lhs')</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refinement_level</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Level of mesh refinement</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cell_points</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of cell vertices</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>bd_dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of boundary points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If mesh file format is invalid</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="k">def</span> <span class="nf">read_mesh</span><span class="p">(</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">mesh_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">boundary_point_refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">bd_sampling_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">refinement_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="p">):</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Reads mesh from a Gmsh .msh file and extracts cell information.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        mesh_file: Path to the mesh file</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        boundary_point_refinement_level: Level of boundary point refinement</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        bd_sampling_method: Method for boundary point sampling (&#39;uniform&#39;/&#39;lhs&#39;)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        refinement_level: Level of mesh refinement</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        cell_points: Array of cell vertices</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        bd_dict: Dictionary of boundary points</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        ValueError: If mesh file format is invalid</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh_file_name</span> <span class="o">=</span> <span class="n">mesh_file</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="c1"># bd_sampling_method = &quot;uniform&quot;  # &quot;uniform&quot; or &quot;lhs&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">file_extension</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">if</span> <span class="n">file_extension</span> <span class="o">!=</span> <span class="s2">&quot;.mesh&quot;</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mesh file should be in .mesh format.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="c1"># Read mesh using meshio</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">mesh_file</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_type</span> <span class="o">==</span> <span class="s2">&quot;quadrilateral&quot;</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="c1"># Extract cell information</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells_dict</span><span class="p">[</span><span class="s2">&quot;quad&quot;</span><span class="p">]</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">num_cells</span> <span class="o">=</span> <span class="n">cells</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Number of cells = </span><span class="si">{</span><span class="n">num_cells</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">cell_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">cells</span><span class="p">][</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="p">:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="p">]</span>  <span class="c1"># remove the z coordinate, which is 0 for all points</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="c1"># loop over all cells and rearrange the points in anticlockwise direction</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cells</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">cell</span> <span class="o">=</span> <span class="n">cell_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="c1"># get the centroid of the cell</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">centroid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="c1"># get the angle of each point with respect to the centroid</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">cell</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cell</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="c1"># sort the points based on the angles</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">cell_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">angles</span><span class="p">)]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1"># Extract number of points within each cell</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : Number of points per cell = </span><span class="si">{</span><span class="n">cell_points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="c1"># Collect the Boundary point id&#39;s within the domain</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">boundary_edges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">cells_dict</span><span class="p">[</span><span class="s2">&quot;line&quot;</span><span class="p">]</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="c1"># Using the point id, collect the coordinates of the boundary points</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="n">boundary_coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">boundary_edges</span><span class="p">]</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="c1"># Number of Existing Boundary points</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="sa">f</span><span class="s2">&quot;[INFO] : Number of Bound points before refinement = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">boundary_coordinates</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="c1"># now Get the physical tag of the boundary edges</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">boundary_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s2">&quot;medit:ref&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="c1"># Generate a Dictionary of boundary tags and boundary coordinates</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="c1"># Keys will be the boundary tags and values will be the list of coordinates</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">boundary_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="c1"># refine the boundary points based on the number of boundary points needed</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">boundary_coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">p1</span> <span class="o">=</span> <span class="n">boundary_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">p2</span> <span class="o">=</span> <span class="n">boundary_coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">if</span> <span class="n">bd_sampling_method</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="c1"># take the current point and next point and then perform a uniform sampling</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">new_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">boundary_point_refinement_level</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">elif</span> <span class="n">bd_sampling_method</span> <span class="o">==</span> <span class="s2">&quot;lhs&quot;</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="c1"># take the current point and next point and then perform a uniform sampling</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">new_points</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">boundary_point_refinement_level</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid sampling method </span><span class="si">{</span><span class="n">bd_sampling_method</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Sampling method should be either uniform or lhs.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="c1"># get the boundary tag</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">tag</span> <span class="o">=</span> <span class="n">boundary_tags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">boundary_dict</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_points</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="n">current_val</span> <span class="o">=</span> <span class="n">new_points</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">prev_val</span> <span class="o">=</span> <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="n">final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">prev_val</span><span class="p">,</span> <span class="n">current_val</span><span class="p">])</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">final</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="c1"># get unique</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">boundary_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">boundary_dict</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span> <span class="o">=</span> <span class="n">boundary_dict</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="c1"># print the new boundary points  on each boundary tag (key) in a tabular format</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">total_bound_points</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="s1">&#39;Boundary ID&#39;</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="s1">&#39;Number of Points&#39;</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">12</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">---</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">16</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;| </span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&lt;16</span><span class="si">}</span><span class="s2"> |&quot;</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">total_bound_points</span> <span class="o">+=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[INFO] : No of bound pts after refinement:  </span><span class="si">{</span><span class="n">total_bound_points</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="c1"># Assign to class values</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cell_points</span> <span class="o">=</span> <span class="n">cell_points</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="c1"># generate testvtk</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">generate_vtk_for_test</span><span class="p">()</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="k">return</span> <span class="n">cell_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bd_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="scirex.core.sciml.fastvpinns.data.datahandler2d.Geometry_2D.write_vtk" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_vtk</span><span class="p">(</span><span class="n">solution</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">data_names</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes the data to a VTK file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solution</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solution data to be written</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output path for the VTK file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the output file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_names</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of data names</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\geometry\geometry_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="k">def</span> <span class="nf">write_vtk</span><span class="p">(</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_names</span><span class="p">:</span> <span class="nb">list</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="p">):</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    Writes the data to a VTK file.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        solution: The solution data to be written</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        output_path: The output path for the VTK file</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">        filename: The name of the output file</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        data_names: List of data names</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        None</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="c1"># read the existing vtk into file</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;internal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;internal.vtk&quot;</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mesh_generation_method</span> <span class="o">==</span> <span class="s2">&quot;external&quot;</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">vtk_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_folder</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;external.vtk&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vtk_file_name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">File</span><span class="p">:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">File</span><span class="p">:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="c1"># get the output file name</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>    <span class="n">output_file_name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">/</span> <span class="n">filename</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="k">if</span> <span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_names</span><span class="p">):</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[Error] : File : geometry_2d.py, Function: write_vtk&quot;</span><span class="p">)</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>            <span class="s2">&quot;Num Columns in solution = &quot;</span><span class="p">,</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>            <span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>            <span class="s2">&quot; Num of data names = &quot;</span><span class="p">,</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="nb">len</span><span class="p">(</span><span class="n">data_names</span><span class="p">),</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Number of data names and solution columns are not equal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="c1"># write the data to the output file</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_file_name</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FN</span><span class="p">:</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">if</span> <span class="s2">&quot;POINT_DATA&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="k">break</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">solution</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;SCALARS &quot;</span> <span class="o">+</span> <span class="n">data_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; float</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;LOOKUP_TABLE default</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">FN</span><span class="p">,</span> <span class="n">solution</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="n">FN</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="scirex.core.sciml.fastvpinns.data.datahandler2d.print_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_table</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">col_1_values</span><span class="p">,</span> <span class="n">col_2_values</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>This function prints a table with two columns to the console.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str: Title of the table</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list: List of column names</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col_1_values</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list: List of values for column 1</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col_2_values</code>
            </td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list: List of values for column</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>scirex\core\sciml\utils\print_utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="k">def</span> <span class="nf">print_table</span><span class="p">(</span><span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">col_1_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">col_2_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    This function prints a table with two columns to the console.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        title: str: Title of the table</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        columns: list: List of column names</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        col_1_values: list: List of values for column 1</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        col_2_values: list: List of values for column</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        None</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1"># Create a console object</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">()</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="c1"># Create a table with a title</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">show_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header_style</span><span class="o">=</span><span class="s2">&quot;bold magenta&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="c1"># Add columns to the table</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># Add rows to the table</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">for</span> <span class="n">val_1</span><span class="p">,</span> <span class="n">val_2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">col_1_values</span><span class="p">,</span> <span class="n">col_2_values</span><span class="p">):</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="c1"># check if val_2 is a float</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val_2</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="c1"># add the row to the table</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">val_1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val_2</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">val_1</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val_2</span><span class="p">))</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="c1"># Print the table to the console</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../../../../assets/custom.js"></script>
      
    
  </body>
</html>